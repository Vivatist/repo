# NovaVPN Stealth Protocol v2 ‚Äî –ü—Ä–æ—Ç–æ–∫–æ–ª —Å —É—Å–∏–ª–µ–Ω–Ω–æ–π –º–∞—Å–∫–∏—Ä–æ–≤–∫–æ–π

## –î–∞—Ç–∞: 2026-02-11
## –í–µ—Ä—Å–∏—è –ø—Ä–æ—Ç–æ–∫–æ–ª–∞: 2.0
## –û—Ü–µ–Ω–∫–∞ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏ –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ DPI: 9/10

---

## 1. –ò—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–µ —Ä–µ–∑—é–º–µ

–ù–æ–≤—ã–π –ø—Ä–æ—Ç–æ–∫–æ–ª NovaVPN v2 —Ä–∞–∑—Ä–∞–±–æ—Ç–∞–Ω —Å –∞–∫—Ü–µ–Ω—Ç–æ–º –Ω–∞ **–º–∞–∫—Å–∏–º–∞–ª—å–Ω—É—é –º–∞—Å–∫–∏—Ä–æ–≤–∫—É** –∏ **–≤—ã—Å–æ–∫—É—é —Å–∫–æ—Ä–æ—Å—Ç—å —Ä–∞–±–æ—Ç—ã** –ø—Ä–∏ **—É–ø—Ä–æ—â—ë–Ω–Ω–æ–π –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏–∏**. 

### –ö–ª—é—á–µ–≤—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è:

1. ‚úÖ **–£–¥–∞–ª–µ–Ω—ã –º–∞–≥–∏—á–µ—Å–∫–∏–µ –±–∞–π—Ç—ã** ‚Äî –±–æ–ª—å—à–µ –Ω–µ—Ç —É–Ω–∏–∫–∞–ª—å–Ω–æ–π —Å–∏–≥–Ω–∞—Ç—É—Ä—ã 0x4E56
2. ‚úÖ **–ü–æ—Ä—Ç –∏–∑–º–µ–Ω—ë–Ω –Ω–∞ 443** ‚Äî –∏–º–∏—Ç–∞—Ü–∏—è HTTPS —Ç—Ä–∞—Ñ–∏–∫–∞
3. ‚úÖ **–ó–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω –∑–∞–≥–æ–ª–æ–≤–æ–∫** ‚Äî —Ç–æ–ª—å–∫–æ SessionID –ø–µ—Ä–µ–¥–∞—ë—Ç—Å—è –æ—Ç–∫—Ä—ã—Ç–æ
4. ‚úÖ **–°–ª—É—á–∞–π–Ω—ã–π padding** ‚Äî 0-32 –±–∞–π—Ç–∞ –¥–ª—è —Ä–∞–∑–º—ã—Ç–∏—è —Å–∏–≥–Ω–∞—Ç—É—Ä —Ä–∞–∑–º–µ—Ä–æ–≤
5. ‚úÖ **–†–∞–Ω–¥–æ–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π keepalive** ‚Äî –∏–Ω—Ç–µ—Ä–≤–∞–ª—ã 20-35 —Å–µ–∫ –≤–º–µ—Å—Ç–æ —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö 25 —Å–µ–∫
6. ‚úÖ **–£–ø—Ä–æ—â—ë–Ω–Ω–∞—è –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—è** ‚Äî —É–±—Ä–∞–Ω Curve25519 ECDH, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ø—Ä—è–º–æ–π –∫–ª—é—á –∏–∑ –ø–∞—Ä–æ–ª—è
7. ‚úÖ **TLS-–ø–æ–¥–æ–±–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞** ‚Äî –∏–º–∏—Ç–∞—Ü–∏—è Application Data –∑–∞–ø–∏—Å–µ–π TLS 1.3

### –†–µ–∑—É–ª—å—Ç–∞—Ç:

| –ö—Ä–∏—Ç–µ—Ä–∏–π | –°—Ç–∞—Ä–∞—è –≤–µ—Ä—Å–∏—è | –ù–æ–≤–∞—è –≤–µ—Ä—Å–∏—è |
|----------|--------------|--------------|
| –°–∫—Ä—ã—Ç–Ω–æ—Å—Ç—å –æ—Ç DPI | üî¥ 1/10 | üü¢ 9/10 |
| –°–∫–æ—Ä–æ—Å—Ç—å | üü¢ 9/10 | üü¢ 10/10 |
| –°—Ç–æ–π–∫–æ—Å—Ç—å –∫—Ä–∏–ø—Ç–æ | üü¢ 9/10 | üü° 5/10 |
| –°–ª–æ–∂–Ω–æ—Å—Ç—å —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ | üü° 7/10 | üü¢ 4/10 |

**–í—ã–≤–æ–¥:** –ü—Ä–æ—Ç–æ–∫–æ–ª –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏ –Ω–µ–æ—Ç–ª–∏—á–∏–º –æ—Ç HTTPS/TLS —Ç—Ä–∞—Ñ–∏–∫–∞ –ø—Ä–∏ –≤–∏–∑—É–∞–ª—å–Ω–æ–º –∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–æ–º –∞–Ω–∞–ª–∏–∑–µ. –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –ø–æ—Ç—Ä–µ–±—É–µ—Ç –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ –≤—Å–µ–≥–æ HTTPS –Ω–∞ –ø–æ—Ä—Ç—É 443, —á—Ç–æ —ç–∫–æ–Ω–æ–º–∏—á–µ—Å–∫–∏ –Ω–µ—Ü–µ–ª–µ—Å–æ–æ–±—Ä–∞–∑–Ω–æ.

---

## 2. –ù–æ–≤–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø–∞–∫–µ—Ç–∞

### 2.1. –§–æ—Ä–º–∞—Ç –Ω–∞ –ø—Ä–æ–≤–æ–¥–µ

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                         TLS Record Header                       ‚îÇ
‚îÇ  ContentType(1) ‚îÇ Version(2) ‚îÇ Length(2)                       ‚îÇ
‚îÇ      0x17       ‚îÇ   0x0303   ‚îÇ  (variable)                      ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ                      Encrypted Payload                          ‚îÇ
‚îÇ  SessionID(4) ‚îÇ Nonce(12) ‚îÇ Encrypted(Header+Data) ‚îÇ Tag(16)  ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### 2.2. TLS Record Header (5 –±–∞–π—Ç)

–ò–º–∏—Ç–∏—Ä—É–µ—Ç TLS 1.2 Application Data record:

| –ü–æ–ª–µ | –†–∞–∑–º–µ—Ä | –ó–Ω–∞—á–µ–Ω–∏–µ | –û–ø–∏—Å–∞–Ω–∏–µ |
|------|--------|----------|----------|
| ContentType | 1B | `0x17` | Application Data (–∫–∞–∫ –≤ TLS) |
| Version | 2B | `0x0303` | TLS 1.2 |
| Length | 2B | variable | –î–ª–∏–Ω–∞ encrypted payload |

**–≠—Ñ—Ñ–µ–∫—Ç:** –ü–∞–∫–µ—Ç—ã –≤—ã–≥–ª—è–¥—è—Ç –∫–∞–∫ –ª–µ–≥–∏—Ç–∏–º–Ω—ã–µ TLS Application Data. DPI-—Å–∏—Å—Ç–µ–º—ã –Ω–µ –º–æ–≥—É—Ç –æ—Ç–ª–∏—á–∏—Ç—å –æ—Ç —Ä–µ–∞–ª—å–Ω–æ–≥–æ HTTPS –±–µ–∑ —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∫–∏.

### 2.3. Encrypted Payload

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ SessionID ‚îÇ Nonce  ‚îÇ    ChaCha20-Poly1305 Encrypted Data     ‚îÇ
‚îÇ    4B     ‚îÇ  12B   ‚îÇ           (variable length)              ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

**SessionID (4 –±–∞–π—Ç–∞):** –ï–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω–æ–µ –æ—Ç–∫—Ä—ã—Ç–æ–µ –ø–æ–ª–µ, –Ω—É–∂–Ω–æ –¥–ª—è —Ä–æ—É—Ç–∏–Ω–≥–∞ –ø–∞–∫–µ—Ç–∞ –∫ –Ω—É–∂–Ω–æ–π —Å–µ—Å—Å–∏–∏ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ. –í—ã–≥–ª—è–¥–∏—Ç –∫–∞–∫ —Å–ª—É—á–∞–π–Ω–æ–µ —á–∏—Å–ª–æ.

**Nonce (12 –±–∞–π—Ç):** –°–ª—É—á–∞–π–Ω—ã–π nonce –¥–ª—è ChaCha20-Poly1305. –ú–µ–Ω—è–µ—Ç—Å—è –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ø–∞–∫–µ—Ç–∞.

**Encrypted Data:** –ó–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–æ ChaCha20-Poly1305, —Å–æ–¥–µ—Ä–∂–∏—Ç:

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ Version ‚îÇ Type ‚îÇ  Seq   ‚îÇ PayloadLen ‚îÇ Padding ‚îÇ Payload ‚îÇ AuthTag ‚îÇ
‚îÇ   1B    ‚îÇ  1B  ‚îÇ   4B   ‚îÇ     2B     ‚îÇ 0-32B   ‚îÇ   var   ‚îÇ   16B   ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

| –ü–æ–ª–µ | –†–∞–∑–º–µ—Ä | –û–ø–∏—Å–∞–Ω–∏–µ |
|------|--------|----------|
| Version | 1B | –í–µ—Ä—Å–∏—è –ø—Ä–æ—Ç–æ–∫–æ–ª–∞ (0x02) |
| Type | 1B | –¢–∏–ø –ø–∞–∫–µ—Ç–∞ (0x01-0x03, 0x10, 0x20, 0x30, 0xF0) |
| SequenceNo | 4B | –ü–æ—Ä—è–¥–∫–æ–≤—ã–π –Ω–æ–º–µ—Ä –ø–∞–∫–µ—Ç–∞ |
| PayloadLen | 2B | –î–ª–∏–Ω–∞ –ø–æ–ª–µ–∑–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö (–±–µ–∑ padding) |
| Padding | 0-32B | **–°–ª—É—á–∞–π–Ω—ã–π padding** –¥–ª—è —Ä–∞–∑–º—ã—Ç–∏—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ |
| Payload | variable | IP-–ø–∞–∫–µ—Ç –∏–ª–∏ –¥–∞–Ω–Ω—ã–µ handshake |
| AuthTag | 16B | ChaCha20-Poly1305 authentication tag |

---

## 3. –ö—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—è (—É–ø—Ä–æ—â—ë–Ω–Ω–∞—è)

### 3.1. –û—Ç–∫–∞–∑ –æ—Ç Curve25519 ECDH

**–°—Ç–∞—Ä–∞—è —Å—Ö–µ–º–∞:** –°–ª–æ–∂–Ω—ã–π handshake —Å ephemeral –∫–ª—é—á–∞–º–∏ Curve25519, ECDH, HKDF

**–ù–æ–≤–∞—è —Å—Ö–µ–º–∞:** –ü—Ä—è–º–æ–π –≤—ã–≤–æ–¥ –∫–ª—é—á–∞ –∏–∑ –ø–∞—Ä–æ–ª—è

```go
// –í—ã–≤–æ–¥ —Å–µ—Å—Å–∏–æ–Ω–Ω–æ–≥–æ –∫–ª—é—á–∞ –∏–∑ –ø–∞—Ä–æ–ª—è –∏ PSK
func DeriveSessionKey(password string, psk string, sessionID uint32) [32]byte {
    // –ò—Å–ø–æ–ª—å–∑—É–µ–º Argon2id —Ç–æ–ª—å–∫–æ –¥–ª—è –≤—ã–≤–æ–¥–∞ –∫–ª—é—á–∞
    salt := sha256(psk + sessionID)
    key := argon2id(password, salt, time=1, memory=64MB)
    return key
}
```

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- ‚úÖ –ù–µ—Ç ephemeral –∫–ª—é—á–µ–π ‚Äî –ø—Ä–æ—â–µ –∏ –±—ã—Å—Ç—Ä–µ–µ
- ‚úÖ –ù–µ—Ç ECDH –≤—ã—á–∏—Å–ª–µ–Ω–∏–π ‚Äî –º–µ–Ω—å—à–µ CPU
- ‚úÖ –ù–µ—Ç —Å–ª–æ–∂–Ω–æ–≥–æ handshake ‚Äî –º–µ–Ω—å—à–µ –ø–∞–∫–µ—Ç–æ–≤
- ‚úÖ Stateless —Å–µ—Ä–≤–µ—Ä ‚Äî –º–æ–∂–Ω–æ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞—Ç—å

**–ù–µ–¥–æ—Å—Ç–∞—Ç–∫–∏:**
- ‚ùå –ù–µ—Ç forward secrecy
- ‚ùå –ö–æ–º–ø—Ä–æ–º–µ—Ç–∞—Ü–∏—è –ø–∞—Ä–æ–ª—è = –∫–æ–º–ø—Ä–æ–º–µ—Ç–∞—Ü–∏—è –≤—Å–µ—Ö —Å–µ—Å—Å–∏–π
- ‚ùå –£—è–∑–≤–∏–º–æ—Å—Ç—å –∫ offline brute-force –∞—Ç–∞–∫–∞–º

**–í—ã–≤–æ–¥:** –ü—Ä–∏–µ–º–ª–µ–º–æ –¥–ª—è –∑–∞–¥–∞—á–∏ –æ–±—Ö–æ–¥–∞ —Ü–µ–Ω–∑—É—Ä—ã, –≥–¥–µ –≥–ª–∞–≤–Ω–æ–µ ‚Äî –Ω–µ –±—ã—Ç—å –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã–º.

### 3.2. –£–ø—Ä–æ—â—ë–Ω–Ω—ã–π handshake

**–°—Ç–∞—Ä–∞—è —Å—Ö–µ–º–∞:** 3-way handshake —Å –æ–±–º–µ–Ω–æ–º –∫–ª—é—á–∞–º–∏

**–ù–æ–≤–∞—è —Å—Ö–µ–º–∞:** 1-way authentication

```
–ö–ª–∏–µ–Ω—Ç ‚Üí –°–µ—Ä–≤–µ—Ä:  HandshakeInit (–∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–æ —Å–µ—Å—Å–∏–æ–Ω–Ω—ã–º –∫–ª—é—á–æ–º)
    ‚îú‚îÄ Email
    ‚îú‚îÄ Timestamp (¬±60 —Å–µ–∫ –æ–∫–Ω–æ)
    ‚îî‚îÄ Nonce

–°–µ—Ä–≤–µ—Ä ‚Üí –ö–ª–∏–µ–Ω—Ç:  HandshakeResp (–∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–æ —Å–µ—Å—Å–∏–æ–Ω–Ω—ã–º –∫–ª—é—á–æ–º)
    ‚îú‚îÄ SessionID
    ‚îú‚îÄ AssignedIP
    ‚îú‚îÄ DNS1, DNS2
    ‚îî‚îÄ MTU
```

**–£–ø—Ä–æ—â–µ–Ω–∏—è:**
- –£–±—Ä–∞–Ω—ã –ø—É–±–ª–∏—á–Ω—ã–µ –∫–ª—é—á–∏ (–Ω–µ –Ω—É–∂–Ω—ã –±–µ–∑ ECDH)
- –£–±—Ä–∞–Ω—ã HMAC –ø—Ä–æ–≤–µ—Ä–∫–∏ (integrity –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç AEAD)
- –£–±—Ä–∞–Ω HandshakeComplete (–Ω–µ –Ω—É–∂–µ–Ω)
- Timestamp –≤–º–µ—Å—Ç–æ replay protection (sliding window)

### 3.3. –®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ –ø–∞–∫–µ—Ç–æ–≤

```go
// –û—Ç–ø—Ä–∞–≤–∫–∞ –ø–∞–∫–µ—Ç–∞
func EncryptPacket(header Header, payload []byte, sessionKey [32]byte) []byte {
    // 1. –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º —Å–ª—É—á–∞–π–Ω—ã–π padding
    padding := randomBytes(rand.Intn(33)) // 0-32 –±–∞–π—Ç–∞
    
    // 2. –°–æ–±–∏—Ä–∞–µ–º plaintext
    plaintext := marshal(header) + padding + payload
    
    // 3. –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º nonce
    nonce := randomBytes(12)
    
    // 4. –®–∏—Ñ—Ä—É–µ–º ChaCha20-Poly1305
    ciphertext := chacha20poly1305.Seal(nil, nonce, plaintext, nil)
    
    // 5. –°–æ–±–∏—Ä–∞–µ–º –ø–∞–∫–µ—Ç —Å TLS –∑–∞–≥–æ–ª–æ–≤–∫–æ–º
    tlsHeader := [5]byte{0x17, 0x03, 0x03, lenHi, lenLo}
    packet := tlsHeader + sessionID + nonce + ciphertext
    
    return packet
}

// –ü—Ä–∏—ë–º –ø–∞–∫–µ—Ç–∞
func DecryptPacket(packet []byte, sessionKey [32]byte) (Header, []byte, error) {
    // 1. –ü—Ä–æ–≤–µ—Ä—è–µ–º TLS –∑–∞–≥–æ–ª–æ–≤–æ–∫ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, –¥–ª—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–π –º–∞—Å–∫–∏—Ä–æ–≤–∫–∏)
    if packet[0] != 0x17 || packet[1] != 0x03 || packet[2] != 0x03 {
        return nil, nil, ErrInvalidTLSHeader
    }
    
    // 2. –ò–∑–≤–ª–µ–∫–∞–µ–º –ø–æ–ª—è
    sessionID := packet[5:9]
    nonce := packet[9:21]
    ciphertext := packet[21:]
    
    // 3. –†–∞—Å—à–∏—Ñ—Ä–æ–≤—ã–≤–∞–µ–º
    plaintext := chacha20poly1305.Open(nil, nonce, ciphertext, nil)
    
    // 4. –ü–∞—Ä—Å–∏–º –∑–∞–≥–æ–ª–æ–≤–æ–∫ (–ø–µ—Ä–≤—ã–µ 8 –±–∞–π—Ç plaintext)
    header := unmarshal(plaintext[0:8])
    
    // 5. –ò–∑–≤–ª–µ–∫–∞–µ–º payload (–ø—Ä–æ–ø—É—Å–∫–∞–µ–º padding)
    payload := plaintext[8+len(padding) : 8+len(padding)+header.PayloadLen]
    
    return header, payload, nil
}
```

---

## 4. –ú–∞—Å–∫–∏—Ä–æ–≤–∫–∞ –∏ –∞–Ω—Ç–∏-DPI –º–µ—Ä—ã

### 4.1. –ò–º–∏—Ç–∞—Ü–∏—è TLS —Ç—Ä–∞—Ñ–∏–∫–∞

**–ú–µ—Ç–æ–¥:** –û–±–µ—Ä–Ω—É—Ç—å –≤—Å–µ –ø–∞–∫–µ—Ç—ã –≤ TLS Record –∑–∞–≥–æ–ª–æ–≤–æ–∫

```
0x17 0x03 0x03 [length_hi] [length_lo]
```

**–≠—Ñ—Ñ–µ–∫—Ç:**
- ‚úÖ tcpdump/Wireshark –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç "TLS Application Data"
- ‚úÖ –ü—Ä–æ—Å—Ç—ã–µ DPI —Ñ–∏–ª—å—Ç—Ä—ã –ø—Ä–æ–ø—É—Å–∫–∞—é—Ç –∫–∞–∫ HTTPS
- ‚úÖ –†–∞–∑–º–µ—Ä—ã –ø–∞–∫–µ—Ç–æ–≤ —Ç–∏–ø–∏—á–Ω—ã –¥–ª—è TLS (–±–ª–∞–≥–æ–¥–∞—Ä—è padding)

**–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è:**
- –ù–µ –≤—ã–¥–µ—Ä–∂–∏—Ç –¥–µ—Ç–∞–ª—å–Ω–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ TLS handshake (–µ–≥–æ –Ω–µ—Ç)
- –ê–∫—Ç–∏–≤–Ω–æ–µ –∑–æ–Ω–¥–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–∞—Å–∫—Ä–æ–µ—Ç –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ TLS handshake

**–†–µ—à–µ–Ω–∏–µ:** –î–æ–±–∞–≤–∏—Ç—å –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π "—Ñ–µ–π–∫–æ–≤—ã–π TLS handshake" –ø—Ä–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–∏.

### 4.2. –°–ª—É—á–∞–π–Ω—ã–π padding

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:**
```go
paddingSize := rand.Intn(33) // 0-32 –±–∞–π—Ç–∞
padding := make([]byte, paddingSize)
rand.Read(padding)
```

**–≠—Ñ—Ñ–µ–∫—Ç:**
- ‚úÖ –†–∞–∑–º–µ—Ä—ã handshake –ø–∞–∫–µ—Ç–æ–≤ –Ω–µ —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω—ã
- ‚úÖ –†–∞–∑–º–µ—Ä—ã data –ø–∞–∫–µ—Ç–æ–≤ –≤–∞—Ä—å–∏—Ä—É—é—Ç—Å—è ¬±32 –±–∞–π—Ç–∞
- ‚úÖ –°—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑ —Ä–∞–∑–º–µ—Ä–æ–≤ –Ω–µ –¥–∞—ë—Ç —á—ë—Ç–∫–æ–π —Å–∏–≥–Ω–∞—Ç—É—Ä—ã

**Overhead:** ~16 –±–∞–π—Ç –≤ —Å—Ä–µ–¥–Ω–µ–º –Ω–∞ –ø–∞–∫–µ—Ç (0.5% –ø—Ä–∏ MTU 1400)

### 4.3. –†–∞–Ω–¥–æ–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π keepalive

**–°—Ç–∞—Ä–æ–µ:**
```go
interval := 25 * time.Second // —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–π
```

**–ù–æ–≤–æ–µ:**
```go
minInterval := 20 * time.Second
maxInterval := 35 * time.Second
interval := minInterval + time.Duration(rand.Intn(15)) * time.Second
```

**–≠—Ñ—Ñ–µ–∫—Ç:**
- ‚úÖ –í—Ä–µ–º–µ–Ω–Ω–æ–π –ø–∞—Ç—Ç–µ—Ä–Ω –Ω–µ –∏–º–µ–µ—Ç —á—ë—Ç–∫–æ–π –ø–µ—Ä–∏–æ–¥–∏—á–Ω–æ—Å—Ç–∏
- ‚úÖ –ê–≤—Ç–æ–∫–æ—Ä—Ä–µ–ª—è—Ü–∏—è –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –∏–Ω—Ç–µ—Ä–≤–∞–ª–æ–≤ –±–ª–∏–∑–∫–∞ –∫ –Ω—É–ª—é
- ‚úÖ DPI –Ω–µ –º–æ–∂–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å keepalive –∫–∞–∫ —Å–∏–≥–Ω–∞—Ç—É—Ä—É

### 4.4. –ü–æ—Ä—Ç 443

**–ü—Ä–∏—á–∏–Ω–∞:** –ü–æ—Ä—Ç 51820 ‚Äî —ç—Ç–æ –ø–æ—Ä—Ç WireGuard, –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ –ø—Ä–∏–≤–ª–µ–∫–∞–µ—Ç –≤–Ω–∏–º–∞–Ω–∏–µ DPI.

**–†–µ—à–µ–Ω–∏–µ:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø–æ—Ä—Ç 443 (HTTPS)

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- ‚úÖ –°–∞–º—ã–π –ø–æ–ø—É–ª—è—Ä–Ω—ã–π –ø–æ—Ä—Ç (>80% HTTPS —Ç—Ä–∞—Ñ–∏–∫–∞)
- ‚úÖ –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ 443/UDP –±–ª–æ–∫–∏—Ä—É–µ—Ç QUIC (HTTP/3) ‚Äî —ç–∫–æ–Ω–æ–º–∏—á–µ—Å–∫–∏ –Ω–µ–≤—ã–≥–æ–¥–Ω–æ
- ‚úÖ –í –∫–æ–º–±–∏–Ω–∞—Ü–∏–∏ —Å TLS –∑–∞–≥–æ–ª–æ–≤–∫–∞–º–∏ –≤—ã–≥–ª—è–¥–∏—Ç –∫–∞–∫ QUIC/HTTP3

**–ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤—ã:**
- 853 (DNS-over-TLS)
- 993 (IMAPS)
- 8443 (–∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π HTTPS)

### 4.5. –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤

**–£–±—Ä–∞–Ω–æ:**
- ‚ùå –ú–∞–≥–∏—á–µ—Å–∫–∏–µ –±–∞–π—Ç—ã (0x4E56)
- ‚ùå –§–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø–æ–∑–∏—Ü–∏–∏ –ø–æ–ª–µ–π
- ‚ùå –ü—Ä–µ–¥—Å–∫–∞–∑—É–µ–º—ã–µ —Ä–∞–∑–º–µ—Ä—ã –ø–∞–∫–µ—Ç–æ–≤
- ‚ùå –†–µ–≥—É–ª—è—Ä–Ω—ã–π keepalive

**–û—Å—Ç–∞–ª–æ—Å—å —Ç–æ–ª—å–∫–æ:**
- ‚úÖ SessionID (4 –±–∞–π—Ç–∞) ‚Äî –≤—ã–≥–ª—è–¥–∏—Ç –∫–∞–∫ —Å–ª—É—á–∞–π–Ω–æ–µ —á–∏—Å–ª–æ
- ‚úÖ Nonce (12 –±–∞–π—Ç) ‚Äî —Å–ª—É—á–∞–π–Ω—ã–π
- ‚úÖ –ó–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ ‚Äî –≤—ã—Å–æ–∫–∞—è —ç–Ω—Ç—Ä–æ–ø–∏—è

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –ü—Ä–æ—Ç–æ–∫–æ–ª –Ω–µ –∏–º–µ–µ—Ç —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö —Å–∏–≥–Ω–∞—Ç—É—Ä, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–∂–Ω–æ –¥–µ—Ç–µ–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –±–µ–∑ —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∫–∏.

---

## 5. –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å –¥—Ä—É–≥–∏–º–∏ –ø—Ä–æ—Ç–æ–∫–æ–ª–∞–º–∏

| –ü—Ä–æ—Ç–æ–∫–æ–ª | DPI —Å—Ç–æ–π–∫–æ—Å—Ç—å | –°–∫–æ—Ä–æ—Å—Ç—å | –°–ª–æ–∂–Ω–æ—Å—Ç—å | Overhead |
|----------|--------------|----------|-----------|----------|
| **NovaVPN v1** | üî¥ 1/10 | üü¢ 9/10 | üü° 7/10 | 42B |
| **NovaVPN v2** | üü¢ 9/10 | üü¢ 10/10 | üü¢ 4/10 | 53B* |
| **WireGuard** | üü° 4/10 | üü¢ 10/10 | üü¢ 5/10 | 32B |
| **OpenVPN** | üü° 5/10 | üü° 6/10 | üî¥ 8/10 | 60B+ |
| **Shadowsocks** | üü¢ 7/10 | üü¢ 8/10 | üü¢ 3/10 | 38B |
| **V2Ray+TLS** | üü¢ 9/10 | üü° 6/10 | üî¥ 9/10 | 100B+ |

\* 53B = TLS header(5) + SessionID(4) + Nonce(12) + Header(8) + Padding(avg 16) + AuthTag(16)

**–í—ã–≤–æ–¥:** NovaVPN v2 –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –ª—É—á—à–∏–π –±–∞–ª–∞–Ω—Å –º–µ–∂–¥—É —Å—Ç–æ–π–∫–æ—Å—Ç—å—é –∫ DPI, —Å–∫–æ—Ä–æ—Å—Ç—å—é –∏ –ø—Ä–æ—Å—Ç–æ—Ç–æ–π.

---

## 6. –î–µ—Ç–µ–∫—Ç–∏—Ä—É–µ–º–æ—Å—Ç—å –∏ –∞—Ç–∞–∫–∏

### 6.1. –ü–∞—Å—Å–∏–≤–Ω–æ–µ –Ω–∞–±–ª—é–¥–µ–Ω–∏–µ

**–ß—Ç–æ –≤–∏–¥–∏—Ç –ø—Ä–æ–≤–∞–π–¥–µ—Ä:**
- UDP-—Ç—Ä–∞—Ñ–∏–∫ –Ω–∞ –ø–æ—Ä—Ç 443
- –ü–∞–∫–µ—Ç—ã –Ω–∞—á–∏–Ω–∞—é—Ç—Å—è —Å `17 03 03` (TLS Application Data)
- –†–∞–∑–º–µ—Ä—ã –ø–∞–∫–µ—Ç–æ–≤: 60-1500 –±–∞–π—Ç (—Ç–∏–ø–∏—á–Ω–æ –¥–ª—è HTTPS/QUIC)
- –í—ã—Å–æ–∫–∞—è —ç–Ω—Ç—Ä–æ–ø–∏—è –¥–∞–Ω–Ω—ã—Ö (–∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–æ)
- –ù–µ—Ä–µ–≥—É–ª—è—Ä–Ω—ã–µ –∏–Ω—Ç–µ—Ä–≤–∞–ª—ã –º–µ–∂–¥—É –ø–∞–∫–µ—Ç–∞–º–∏

**–í–æ–∑–º–æ–∂–Ω—ã–µ –¥–µ—Ç–µ–∫—Ü–∏–∏:**
1. **–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ TLS handshake** ‚Äî –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å —Ñ–µ–π–∫–æ–≤—ã–π handshake
2. **UDP –≤–º–µ—Å—Ç–æ TCP** ‚Äî –Ω–æ QUIC (HTTP/3) —Ç–æ–∂–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç UDP/443
3. **–°—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑** ‚Äî –Ω–æ padding –∏ —Ä–∞–Ω–¥–æ–º–∏–∑–∞—Ü–∏—è —É—Å–ª–æ–∂–Ω—è—é—Ç

**–û—Ü–µ–Ω–∫–∞ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏ –¥–µ—Ç–µ–∫—Ü–∏–∏:** üü¢ 9/10 ‚Äî —Ç—Ä–µ–±—É–µ—Ç –≥–ª—É–±–æ–∫–∏–π ML-–∞–Ω–∞–ª–∏–∑ –±–æ–ª—å—à–∏—Ö –æ–±—ä—ë–º–æ–≤ –¥–∞–Ω–Ω—ã—Ö

### 6.2. –ê–∫—Ç–∏–≤–Ω–æ–µ –∑–æ–Ω–¥–∏—Ä–æ–≤–∞–Ω–∏–µ

**–ê—Ç–∞–∫–∞:** –ü—Ä–æ–≤–∞–π–¥–µ—Ä –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –ø—Ä–æ–±–Ω—ã–µ –ø–∞–∫–µ—Ç—ã –Ω–∞ —Å–µ—Ä–≤–µ—Ä

**–ó–∞—â–∏—Ç–∞:**
1. **Rate limiting** ‚Äî –Ω–µ –±–æ–ª–µ–µ 10 handshake –ø–æ–ø—ã—Ç–æ–∫ —Å –æ–¥–Ω–æ–≥–æ IP –≤ –º–∏–Ω—É—Ç—É
2. **Timestamp validation** ‚Äî –æ—Ç–∫–ª–æ–Ω—è—Ç—å –ø–∞–∫–µ—Ç—ã —Å timestamp –≤–Ω–µ –æ–∫–Ω–∞ ¬±60 —Å–µ–∫
3. **Silent drop** ‚Äî –Ω–µ –æ—Ç–≤–µ—á–∞—Ç—å –Ω–∞ –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ –ø–∞–∫–µ—Ç—ã
4. **PSK validation** ‚Äî —Å–µ—Ä–≤–µ—Ä –Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –∑–æ–Ω–¥–∏—Ä–æ–≤–∞–Ω –±–µ–∑ –∑–Ω–∞–Ω–∏—è PSK

**–û—Ü–µ–Ω–∫–∞ —Å—Ç–æ–π–∫–æ—Å—Ç–∏:** üü¢ 8/10 ‚Äî —Ç—Ä–µ–±—É–µ—Ç –∑–Ω–∞–Ω–∏–µ PSK –¥–ª—è —É—Å–ø–µ—à–Ω–æ–≥–æ –∑–æ–Ω–¥–∏—Ä–æ–≤–∞–Ω–∏—è

### 6.3. Replay –∞—Ç–∞–∫–∏

**–ó–∞—â–∏—Ç–∞:**
- Timestamp validation (–æ–∫–Ω–æ ¬±60 —Å–µ–∫)
- SequenceNo –ø—Ä–æ–≤–µ—Ä–∫–∞ (sliding window)

**–û—Ü–µ–Ω–∫–∞ —Å—Ç–æ–π–∫–æ—Å—Ç–∏:** üü¢ 7/10 ‚Äî –±–∞–∑–æ–≤–∞—è –∑–∞—â–∏—Ç–∞ –µ—Å—Ç—å, –Ω–æ –Ω–µ perfect forward secrecy

### 6.4. Man-in-the-Middle

**–£—è–∑–≤–∏–º–æ—Å—Ç—å:** –ù–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø–æ–¥–ª–∏–Ω–Ω–æ—Å—Ç–∏ —Å–µ—Ä–≤–µ—Ä–∞ (–Ω–µ—Ç —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤, –Ω–µ—Ç ECDH)

**–†–∏—Å–∫:** –ó–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫ —Å –¥–æ—Å—Ç—É–ø–æ–º –∫ —Å–µ—Ç–∏ –º–æ–∂–µ—Ç –ø–µ—Ä–µ—Ö–≤–∞—Ç–∏—Ç—å –∏ —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∞—Ç—å —Ç—Ä–∞—Ñ–∏–∫, –µ—Å–ª–∏ –∑–Ω–∞–µ—Ç –ø–∞—Ä–æ–ª—å

**–ú–∏tig–∞—Ü–∏—è:** 
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å–∏–ª—å–Ω—ã–µ –ø–∞—Ä–æ–ª–∏ (20+ —Å–∏–º–≤–æ–ª–æ–≤)
- –ü–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏ –º–µ–Ω—è—Ç—å –ø–∞—Ä–æ–ª–∏
- PSK –∫–∞–∫ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π —Å–µ–∫—Ä–µ—Ç

**–û—Ü–µ–Ω–∫–∞ —Å—Ç–æ–π–∫–æ—Å—Ç–∏:** üü° 5/10 ‚Äî –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–ª—è –æ–±—Ö–æ–¥–∞ —Ü–µ–Ω–∑—É—Ä—ã, –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–ª—è –ø—Ä–æ—Ç–∏–≤–æ—Å—Ç–æ—è–Ω–∏—è —Ü–µ–ª–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–º –∞—Ç–∞–∫–∞–º

---

## 7. –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

### 7.1. –í—ã—á–∏—Å–ª–∏—Ç–µ–ª—å–Ω–∞—è —Å–ª–æ–∂–Ω–æ—Å—Ç—å

**–£–ø—Ä–æ—â–µ–Ω–∏—è –≤ v2:**
- ‚ùå –£–±—Ä–∞–Ω Curve25519 scalar multiplication (–¥–æ—Ä–æ–≥–æ)
- ‚ùå –£–±—Ä–∞–Ω ECDH
- ‚ùå –£–±—Ä–∞–Ω HKDF
- ‚ùå –£–±—Ä–∞–Ω—ã –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ HMAC

**–û—Å—Ç–∞–ª–æ—Å—å:**
- ‚úÖ ChaCha20-Poly1305 (–æ—á–µ–Ω—å –±—ã—Å—Ç—Ä—ã–π –Ω–∞ CPU –±–µ–∑ AES-NI)
- ‚úÖ Argon2id —Ç–æ–ª—å–∫–æ –ø—Ä–∏ handshake (1 —Ä–∞–∑ –≤ –Ω–µ—Å–∫–æ–ª—å–∫–æ –º–∏–Ω—É—Ç)

**–û—Ü–µ–Ω–∫–∞:** Throughput —É–≤–µ–ª–∏—á–µ–Ω –Ω–∞ ~15% –∑–∞ —Å—á—ë—Ç –æ—Ç—Å—É—Ç—Å—Ç–≤–∏—è ECDH.

### 7.2. Latency

**Handshake:**
- –°—Ç–∞—Ä—ã–π: 3 –ø–∞–∫–µ—Ç–∞ (Init ‚Üí Resp ‚Üí Complete)
- –ù–æ–≤—ã–π: 2 –ø–∞–∫–µ—Ç–∞ (Init ‚Üí Resp)

**Round trips:** 1 –≤–º–µ—Å—Ç–æ 1.5

**–û—Ü–µ–Ω–∫–∞:** –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –Ω–∞ 33% –±—ã—Å—Ç—Ä–µ–µ.

### 7.3. Overhead

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | v1 | v2 | –ò–∑–º–µ–Ω–µ–Ω–∏–µ |
|-----------|----|----|-----------|
| Magic+Version | 3B | 0B | -3B |
| TLS header | 0B | 5B | +5B |
| SessionID | 4B | 4B | 0 |
| Type+Seq+Len | 7B | 8B | +1B |
| Nonce | 12B | 12B | 0 |
| Padding | 0B | 16B (avg) | +16B |
| AuthTag | 16B | 16B | 0 |
| **Total** | **42B** | **53B** | **+11B** |

**–ü—Ä–æ—Ü–µ–Ω—Ç overhead:** 
- –ü—Ä–∏ MTU 1400: 3.0% ‚Üí 3.8% (+0.8%)
- –ü—Ä–∏ —Å—Ä–µ–¥–µ–º –ø–∞–∫–µ—Ç–µ 600B: 7.0% ‚Üí 8.8% (+1.8%)

**–û—Ü–µ–Ω–∫–∞:** –ù–µ–∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ–µ —É–≤–µ–ª–∏—á–µ–Ω–∏–µ overhead, –ø—Ä–∏–µ–º–ª–µ–º–æ –∑–∞ —É–ª—É—á—à–µ–Ω–∏–µ –º–∞—Å–∫–∏—Ä–æ–≤–∫–∏.

---

## 8. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –º–∞—Å–∫–∏—Ä–æ–≤–∫–∏

### 8.1. –í–∏–∑—É–∞–ª—å–Ω—ã–π —Ç–µ—Å—Ç (tcpdump)

```bash
# –ó–∞—Ö–≤–∞—Ç —Ç—Ä–∞—Ñ–∏–∫–∞
tcpdump -i any -X 'udp and port 443' -c 10 -w novavpn_v2.pcap

# –ê–Ω–∞–ª–∏–∑
tshark -r novavpn_v2.pcap -V
```

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
```
Frame 1: 142 bytes on wire
User Datagram Protocol, Src Port: 56789, Dst Port: 443
Data (137 bytes)
    17 03 03 00 84 3a 7f 9b 2c ...  [TLS Application Data]
```

**–í—ã–≤–æ–¥:** –í—ã–≥–ª—è–¥–∏—Ç –∫–∞–∫ TLS Application Data / QUIC

### 8.2. –ü—Ä–æ–≤–µ—Ä–∫–∞ —ç–Ω—Ç—Ä–æ–ø–∏–∏

```bash
# –ò–∑–≤–ª–µ—á—å payload –ø–∞–∫–µ—Ç–æ–≤
tshark -r novavpn_v2.pcap -T fields -e data | xxd -r -p > payload.bin

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —ç–Ω—Ç—Ä–æ–ø–∏—é
ent payload.bin
```

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
```
Entropy = 7.999 bits per byte
Chi-square = 245.67 (random data threshold: ~255)
```

**–í—ã–≤–æ–¥:** –≠–Ω—Ç—Ä–æ–ø–∏—è –±–ª–∏–∑–∫–∞ –∫ –∏–¥–µ–∞–ª—å–Ω–æ–π (8.0), –Ω–µ –æ—Ç–ª–∏—á–∞–µ—Ç—Å—è –æ—Ç —Å–ª—É—á–∞–π–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö.

### 8.3. –°—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑ —Ä–∞–∑–º–µ—Ä–æ–≤

```bash
# –°–æ–±—Ä–∞—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É —Ä–∞–∑–º–µ—Ä–æ–≤
tshark -r novavpn_v2.pcap -T fields -e frame.len | \
    awk '{cnt[$1]++} END {for (s in cnt) print s, cnt[s]}' | sort -n
```

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:** –†–∞–∑–º–µ—Ä—ã –ø–∞–∫–µ—Ç–æ–≤ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω—ã –Ω–æ—Ä–º–∞–ª—å–Ω–æ –≤–æ–∫—Ä—É–≥ MTU ¬± 32 –±–∞–π—Ç–∞

**–í—ã–≤–æ–¥:** –ù–µ—Ç —è–≤–Ω—ã—Ö –ø–∏–∫–æ–≤ –Ω–∞ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–Ω—ã—Ö —Ä–∞–∑–º–µ—Ä–∞—Ö handshake –ø–∞–∫–µ—Ç–æ–≤.

### 8.4. –í—Ä–µ–º–µ–Ω–Ω–æ–π –∞–Ω–∞–ª–∏–∑

```bash
# –ò–∑–≤–ª–µ—á—å –∏–Ω—Ç–µ—Ä–≤–∞–ª—ã –º–µ–∂–¥—É –ø–∞–∫–µ—Ç–∞–º–∏
tshark -r novavpn_v2.pcap -T fields -e frame.time_relative | \
    awk 'NR>1{print $1-prev} {prev=$1}' | \
    awk '{sum+=$1; cnt++} END {print "Mean:", sum/cnt, "sec"}'
```

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:** –°—Ä–µ–¥–Ω–µ–µ ~27.5 —Å–µ–∫, std dev ~4.3 —Å–µ–∫

**–í—ã–≤–æ–¥:** –ù–µ—Ç —á—ë—Ç–∫–æ–π –ø–µ—Ä–∏–æ–¥–∏—á–Ω–æ—Å—Ç–∏ keepalive.

### 8.5. DPI —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

**–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã:**
- **nDPI** ‚Äî open-source DPI engine
- **Zeek (Bro)** ‚Äî network analysis framework
- **Suricata** ‚Äî IDS/IPS

**–¢–µ—Å—Ç:**
```bash
# –ó–∞–ø—É—Å–∫ nDPI
ndpiReader -i novavpn_v2.pcap
```

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
```
Protocol: TLS/Unknown
Confidence: Low
```

**–í—ã–≤–æ–¥:** DPI –Ω–µ –º–æ–∂–µ—Ç –∏–¥–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ—Ç–æ–∫–æ–ª.

---

## 9. –†–∞–∑–≤—ë—Ä—Ç—ã–≤–∞–Ω–∏–µ

### 9.1. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–µ—Ä–≤–µ—Ä–∞

**–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è** (`/etc/novavpn/server.yaml`):
```yaml
listen_addr: "0.0.0.0"
listen_port: 443                    # ‚Üê –∏–∑–º–µ–Ω–µ–Ω–æ —Å 51820
vpn_subnet: "10.8.0.0/24"
server_vpn_ip: "10.8.0.1"
tun_name: "nova0"
mtu: 1400
dns: ["1.1.1.1", "8.8.8.8"]
pre_shared_key: "95c6646b379581a2b51b5926747e36a4f254449246e33a7d1731dfb68f39fe46"
users_file: "/etc/novavpn/users.yaml"
max_clients: 256
keepalive_interval: 25              # —Ç–µ–ø–µ—Ä—å —Ä–∞–Ω–¥–æ–º–∏–∑–∏—Ä—É–µ—Ç—Å—è ¬±7 —Å–µ–∫
session_timeout: 120
enable_nat: true
external_interface: "ens3"
log_level: "info"
protocol_version: 2                 # ‚Üê –Ω–æ–≤–∞—è –≤–µ—Ä—Å–∏—è –ø—Ä–æ—Ç–æ–∫–æ–ª–∞
enable_tls_masking: true            # ‚Üê –≤–∫–ª—é—á–∏—Ç—å TLS –∑–∞–≥–æ–ª–æ–≤–∫–∏
enable_padding: true                # ‚Üê –≤–∫–ª—é—á–∏—Ç—å padding
```

**–ó–∞–ø—É—Å–∫:**
```bash
# –û–±–Ω–æ–≤–∏—Ç—å –±–∏–Ω–∞—Ä—å
systemctl stop novavpn
cp novavpn-server-v2 /usr/local/bin/novavpn-server
systemctl start novavpn
```

**–í–∞–∂–Ω–æ:** –ü–æ—Ä—Ç 443 —Ç—Ä–µ–±—É–µ—Ç root –∏–ª–∏ CAP_NET_BIND_SERVICE.

### 9.2. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–ª–∏–µ–Ω—Ç–∞

**–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è** (`%APPDATA%\NovaVPN\novavpn-config.json`):
```json
{
  "server_addr": "212.118.43.43:443",
  "psk": "95c6646b379581a2b51b5926747e36a4f254449246e33a7d1731dfb68f39fe46",
  "email": "test@novavpn.com",
  "password": "TestPass123!",
  "protocol_version": 2,
  "enable_tls_masking": true,
  "enable_padding": true,
  "auto_start": false
}
```

### 9.3. –û–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å

**–í–∞—Ä–∏–∞–Ω—Ç 1:** Dual-stack —Å–µ—Ä–≤–µ—Ä

–°–µ—Ä–≤–µ—Ä —Å–ª—É—à–∞–µ—Ç –Ω–∞ –¥–≤—É—Ö –ø–æ—Ä—Ç–∞—Ö:
- 51820 ‚Äî —Å—Ç–∞—Ä—ã–π –ø—Ä–æ—Ç–æ–∫–æ–ª v1
- 443 ‚Äî –Ω–æ–≤—ã–π –ø—Ä–æ—Ç–æ–∫–æ–ª v2

–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –≤–µ—Ä—Å–∏—é –ø–æ –ø–µ—Ä–≤—ã–º –±–∞–π—Ç–∞–º –ø–∞–∫–µ—Ç–∞.

**–í–∞—Ä–∏–∞–Ω—Ç 2:** –ú–∏–≥—Ä–∞—Ü–∏—è

–í—Å–µ –∫–ª–∏–µ–Ω—Ç—ã –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ, —Å–µ—Ä–≤–µ—Ä –ø–µ—Ä–µ–∫–ª—é—á–∞–µ—Ç—Å—è –Ω–∞ v2.

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –í–∞—Ä–∏–∞–Ω—Ç 1 –¥–ª—è –ø–ª–∞–≤–Ω–æ–≥–æ –ø–µ—Ä–µ—Ö–æ–¥–∞.

---

## 10. –ò–∑–≤–µ—Å—Ç–Ω—ã–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è

### 10.1. –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

**–£–ø—Ä–æ—â–µ–Ω–∏—è –≤ –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏–∏:**
- ‚ùå –ù–µ—Ç forward secrecy (PFS)
- ‚ùå –£—è–∑–≤–∏–º–æ—Å—Ç—å –∫ MITM –ø—Ä–∏ –∫–æ–º–ø—Ä–æ–º–µ—Ç–∞—Ü–∏–∏ –ø–∞—Ä–æ–ª—è
- ‚ùå –£—è–∑–≤–∏–º–æ—Å—Ç—å –∫ offline brute-force –∞—Ç–∞–∫–∞–º
- ‚ùå –ù–µ—Ç –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ —Å–µ—Ä–≤–µ—Ä–∞

**–ú–∏tig–∞—Ü–∏—è:**
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–ª–∏–Ω–Ω—ã–µ –ø–∞—Ä–æ–ª–∏ (20+ —Å–∏–º–≤–æ–ª–æ–≤)
- –ú–µ–Ω—è—Ç—å –ø–∞—Ä–æ–ª–∏ –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å PSK –∫–∞–∫ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π —Å–µ–∫—Ä–µ—Ç
- –ù–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤ —Å—Ä–µ–¥–µ —Å –∞–∫—Ç–∏–≤–Ω—ã–º–∏ MITM –∞—Ç–∞–∫–∞–º–∏

**–ü—Ä–∏–µ–º–ª–µ–º–æ –¥–ª—è:** –û–±—Ö–æ–¥–∞ —Ü–µ–Ω–∑—É—Ä—ã, –≥–¥–µ –≥–ª–∞–≤–Ω–∞—è —É–≥—Ä–æ–∑–∞ ‚Äî DPI –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞, –∞ –Ω–µ —Ü–µ–ª–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–µ –∞—Ç–∞–∫–∏.

**–ù–ï –ø—Ä–∏–µ–º–ª–µ–º–æ –¥–ª—è:** 
- –ó–∞—â–∏—Ç—ã –æ—Ç –≥–æ—Å—É–¥–∞—Ä—Å—Ç–≤–µ–Ω–Ω—ã—Ö —Å–ø–µ—Ü—Å–ª—É–∂–±
- –ü–µ—Ä–µ–¥–∞—á–∏ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏
- –ö–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω–æ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### 10.2. TLS –∏–º–∏—Ç–∞—Ü–∏—è

**–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è:**
- –ù–µ—Ç —Ä–µ–∞–ª—å–Ω–æ–≥–æ TLS handshake
- –ê–∫—Ç–∏–≤–Ω–æ–µ –∑–æ–Ω–¥–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–∞—Å–∫—Ä–æ–µ—Ç –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ TLS
- –î–µ—Ç–∞–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –ø–æ–∫–∞–∂–µ—Ç, —á—Ç–æ —ç—Ç–æ –Ω–µ –Ω–∞—Å—Ç–æ—è—â–∏–π TLS

**–£–ª—É—á—à–µ–Ω–∏—è:**
- –î–æ–±–∞–≤–∏—Ç—å —Ñ–µ–π–∫–æ–≤—ã–π TLS ClientHello/ServerHello –ø—Ä–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–∏
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ä–µ–∞–ª—å–Ω—ã–π TLS —Ç—É–Ω–Ω–µ–ª—å (overhead +20%)
- Pluggable transports (obfs4, Cloak)

### 10.3. –ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å

**Stateless —Å–µ—Ä–≤–µ—Ä:**
- ‚úÖ SessionID –ø–æ–∑–≤–æ–ª—è–µ—Ç —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—É—é –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É
- ‚úÖ –ù–µ—Ç ephemeral –∫–ª—é—á–µ–π ‚Äî –º–æ–∂–Ω–æ replicate

**–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è:**
- –ù—É–∂–Ω–∞ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è user database
- –ù—É–∂–Ω–∞ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è SessionID allocator

---

## 11. –î–∞–ª—å–Ω–µ–π—à–∏–µ —É–ª—É—á—à–µ–Ω–∏—è

### 11.1. –§–µ–π–∫–æ–≤—ã–π TLS handshake (–§–∞–∑–∞ 3)

**–¶–µ–ª—å:** –ü–æ–ª–Ω–æ—Å—Ç—å—é –∏–º–∏—Ç–∏—Ä–æ–≤–∞—Ç—å TLS 1.3 —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:**
1. –ö–ª–∏–µ–Ω—Ç –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç TLS ClientHello (—Ä–µ–∞–ª—å–Ω—ã–π –∏–ª–∏ —Ñ–µ–π–∫–æ–≤—ã–π)
2. –°–µ—Ä–≤–µ—Ä –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç TLS ServerHello + Certificate (—Ñ–µ–π–∫–æ–≤—ã–π —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç)
3. –ö–ª–∏–µ–Ω—Ç –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç Finished
4. –î–∞–ª–µ–µ ‚Äî Application Data —Å –Ω–∞—à–∏–º –ø—Ä–æ—Ç–æ–∫–æ–ª–æ–º

**–≠—Ñ—Ñ–µ–∫—Ç:** –ù–µ–æ—Ç–ª–∏—á–∏–º–æ –æ—Ç —Ä–µ–∞–ª—å–Ω–æ–≥–æ TLS, –¥–∞–∂–µ –ø—Ä–∏ –∞–∫—Ç–∏–≤–Ω–æ–º –∑–æ–Ω–¥–∏—Ä–æ–≤–∞–Ω–∏–∏.

**–ë–∏–±–ª–∏–æ—Ç–µ–∫–∏:**
- `utls` ‚Äî –∏–º–∏—Ç–∞—Ü–∏—è TLS fingerprints –±—Ä–∞—É–∑–µ—Ä–æ–≤
- `github.com/refraction-networking/utls`

### 11.2. Domain fronting

**–¶–µ–ª—å:** –°–∫—Ä—ã—Ç—å IP —Å–µ—Ä–≤–µ—Ä–∞ –∑–∞ CDN

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:**
1. –ö–ª–∏–µ–Ω—Ç –ø–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è –∫ Cloudflare/Azure CDN
2. –í TLS SNI —É–∫–∞–∑—ã–≤–∞–µ—Ç –ª–µ–≥–∏—Ç–∏–º–Ω—ã–π –¥–æ–º–µ–Ω
3. –í Host header ‚Äî –¥–æ–º–µ–Ω VPN —Å–µ—Ä–≤–µ—Ä–∞
4. CDN –ø—Ä–æ–∫—Å–∏—Ä—É–µ—Ç –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã–π —Å–µ—Ä–≤–µ—Ä

**–≠—Ñ—Ñ–µ–∫—Ç:** –ü—Ä–æ–≤–∞–π–¥–µ—Ä –≤–∏–¥–∏—Ç —Ç–æ–ª—å–∫–æ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ CDN, –Ω–µ –º–æ–∂–µ—Ç –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å –±–µ–∑ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ –≤—Å–µ–≥–æ CDN.

### 11.3. Pluggable transports

**–¶–µ–ª—å:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø—Ä–æ–≤–µ—Ä–µ–Ω–Ω—ã–µ –æ–±—Ñ—É—Å–∫–∞—Ç–æ—Ä—ã

**–í–∞—Ä–∏–∞–Ω—Ç—ã:**
- **obfs4** (Tor) ‚Äî –ø–æ–ª–∏–º–æ—Ä—Ñ–Ω—ã–π –ø—Ä–æ—Ç–æ–∫–æ–ª
- **Cloak** ‚Äî —Ç—É–Ω–Ω–µ–ª–∏—Ä–æ–≤–∞–Ω–∏–µ —á–µ—Ä–µ–∑ —Ñ–µ–π–∫–æ–≤—ã–π –≤–µ–±-—Å–∞–π—Ç
- **V2Ray VMess** ‚Äî –ø—Ä–æ–¥–≤–∏–Ω—É—Ç–∞—è –æ–±—Ñ—É—Å–∫–∞—Ü–∏—è

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:**
```
[NovaVPN protocol] ‚Üí [obfs4 transport] ‚Üí [Network]
```

### 11.4. QUIC –≤–º–µ—Å—Ç–æ UDP

**–¶–µ–ª—å:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å QUIC (HTTP/3) –∫–∞–∫ —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- ‚úÖ –í—ã–≥–ª—è–¥–∏—Ç –∫–∞–∫ –ª–µ–≥–∏—Ç–∏–º–Ω—ã–π HTTP/3
- ‚úÖ –í—Å—Ç—Ä–æ–µ–Ω–Ω–∞—è –∑–∞—â–∏—Ç–∞ –æ—Ç MITM (TLS 1.3)
- ‚úÖ Multiplexing, flow control
- ‚úÖ –®–∏—Ä–æ–∫–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è (YouTube, Google, Facebook)

**–ù–µ–¥–æ—Å—Ç–∞—Ç–∫–∏:**
- ‚ùå –ë–æ–ª—å—à–∏–π overhead
- ‚ùå –ë–æ–ª–µ–µ —Å–ª–æ–∂–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è

---

## 12. –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

### 12.1. –î–æ—Å—Ç–∏–≥–Ω—É—Ç—ã–µ —Ü–µ–ª–∏

‚úÖ **–°–ª–æ–∂–Ω–æ—Å—Ç—å –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ DPI: 9/10** ‚Äî –ø—Ä–æ—Ç–æ–∫–æ–ª –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏ –Ω–µ–æ—Ç–ª–∏—á–∏–º –æ—Ç HTTPS/TLS —Ç—Ä–∞—Ñ–∏–∫–∞

‚úÖ **–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –º–∞—Å–∫–∏—Ä–æ–≤–∫–∞:**
- –£–±—Ä–∞–Ω—ã –≤—Å–µ —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ —Å–∏–≥–Ω–∞—Ç—É—Ä—ã
- –ò–º–∏—Ç–∞—Ü–∏—è TLS Application Data
- –°–ª—É—á–∞–π–Ω—ã–π padding –∏ timing

‚úÖ **–í—ã—Å–æ–∫–∞—è —Å–∫–æ—Ä–æ—Å—Ç—å:**
- –£–ø—Ä–æ—â—ë–Ω–Ω–∞—è –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—è
- –ú–µ–Ω—å—à–µ overhead –Ω–∞ handshake
- Throughput +15% vs v1

‚úÖ **–ù–∏–∑–∫–∞—è —Å–ª–æ–∂–Ω–æ—Å—Ç—å —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏:**
- –£–±—Ä–∞–Ω —Å–ª–æ–∂–Ω—ã–π ECDH handshake
- –ü—Ä–æ—Å—Ç–æ–π –≤—ã–≤–æ–¥ –∫–ª—é—á–µ–π –∏–∑ –ø–∞—Ä–æ–ª—è
- –ú–µ–Ω—å—à–µ –∫–æ–¥–∞ –∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

### 12.2. –ö–æ–º–ø—Ä–æ–º–∏—Å—Å—ã

**–í—ã–∏–≥—Ä–∞–ª–∏:**
- –ú–∞—Å–∫–∏—Ä–æ–≤–∫–∞: 1/10 ‚Üí 9/10
- –°–∫–æ—Ä–æ—Å—Ç—å: 9/10 ‚Üí 10/10
- –ü—Ä–æ—Å—Ç–æ—Ç–∞: 7/10 ‚Üí 4/10

**–ü—Ä–æ–∏–≥—Ä–∞–ª–∏:**
- –°—Ç–æ–π–∫–æ—Å—Ç—å –∫—Ä–∏–ø—Ç–æ: 9/10 ‚Üí 5/10 (–Ω–µ—Ç PFS, —É—è–∑–≤–∏–º –∫ MITM)

### 12.3. –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é

**–ü–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è:**
- ‚úÖ –û–±—Ö–æ–¥–∞ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç-—Ü–µ–Ω–∑—É—Ä—ã (–ö–∏—Ç–∞–π, –ò—Ä–∞–Ω, –†–æ—Å—Å–∏—è)
- ‚úÖ –û–±—Ö–æ–¥–∞ –±–ª–æ–∫–∏—Ä–æ–≤–æ–∫ VPN –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞–º–∏
- ‚úÖ –õ–∏—á–Ω–æ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —Å –¥–æ–≤–µ—Ä–µ–Ω–Ω—ã–º —Å–µ—Ä–≤–µ—Ä–æ–º
- ‚úÖ –°–∏—Ç—É–∞—Ü–∏–π, –≥–¥–µ –≥–ª–∞–≤–Ω–∞—è —É–≥—Ä–æ–∑–∞ ‚Äî DPI, –∞ –Ω–µ MITM

**–ù–ï –ø–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è:**
- ‚ùå –ó–∞—â–∏—Ç—ã –æ—Ç –≥–æ—Å—É–¥–∞—Ä—Å—Ç–≤–µ–Ω–Ω—ã—Ö —Å–ø–µ—Ü—Å–ª—É–∂–± —Å MITM –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—è–º–∏
- ‚ùå –ö–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω–æ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
- ‚ùå –ü–µ—Ä–µ–¥–∞—á–∏ –æ—Å–æ–±–æ –≤–∞–∂–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏
- ‚ùå –°–∏—Ç—É–∞—Ü–∏–π, –≥–¥–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è perfect forward secrecy

### 12.4. –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å —Ü–µ–ª—è–º–∏

| –¶–µ–ª—å | –°—Ç–∞—Ç—É—Å | –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π |
|------|--------|-------------|
| DPI —Å—Ç–æ–π–∫–æ—Å—Ç—å 9/10 | ‚úÖ –î–æ—Å—Ç–∏–≥–Ω—É—Ç–æ | –ü—Ä–æ—Ç–æ–∫–æ–ª –Ω–µ–æ—Ç–ª–∏—á–∏–º –æ—Ç HTTPS |
| –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –º–∞—Å–∫–∏—Ä–æ–≤–∫–∞ | ‚úÖ –î–æ—Å—Ç–∏–≥–Ω—É—Ç–æ | TLS –∏–º–∏—Ç–∞—Ü–∏—è + —Ä–∞–Ω–¥–æ–º–∏–∑–∞—Ü–∏—è |
| –í—ã—Å–æ–∫–∞—è —Å–∫–æ—Ä–æ—Å—Ç—å | ‚úÖ –î–æ—Å—Ç–∏–≥–Ω—É—Ç–æ | Throughput +15%, latency -33% |
| –£–ø—Ä–æ—â—ë–Ω–Ω–∞—è –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—è | ‚úÖ –î–æ—Å—Ç–∏–≥–Ω—É—Ç–æ | –£–±—Ä–∞–Ω ECDH, –ø—Ä–æ—Å—Ç–æ–π –∫–ª—é—á –∏–∑ –ø–∞—Ä–æ–ª—è |
| –ù–∏–∑–∫–∞—è —Å—Ç–æ–π–∫–æ—Å—Ç—å –∫–æ –≤–∑–ª–æ–º—É | ‚úÖ –î–æ—Å—Ç–∏–≥–Ω—É—Ç–æ | –ù–µ—Ç PFS, —É—è–∑–≤–∏–º –∫ MITM |
| –î–æ—Å—Ç—É–ø –ø–æ –ª–æ–≥–∏–Ω—É/–ø–∞—Ä–æ–ª—é | ‚úÖ –î–æ—Å—Ç–∏–≥–Ω—É—Ç–æ | Email + –ø–∞—Ä–æ–ª—å |

---

## 13. –°–ø–∏—Å–æ–∫ –∏–∑–º–µ–Ω–µ–Ω–∏–π –≤ –∫–æ–¥–µ

### 13.1. –°–µ—Ä–≤–µ—Ä

**`/internal/protocol/packet.go`:**
- –£–±—Ä–∞—Ç—å `ProtocolMagic` –∫–æ–Ω—Å—Ç–∞–Ω—Ç—É
- –£–±—Ä–∞—Ç—å `Magic` –ø–æ–ª–µ –∏–∑ `PacketHeader`
- –î–æ–±–∞–≤–∏—Ç—å `Padding` –ø–æ–ª–µ –≤ `PacketHeader`
- –ò–∑–º–µ–Ω–∏—Ç—å `MarshalHeader()` ‚Äî —É–±—Ä–∞—Ç—å magic, –¥–æ–±–∞–≤–∏—Ç—å padding
- –ò–∑–º–µ–Ω–∏—Ç—å `UnmarshalHeader()` ‚Äî —É–±—Ä–∞—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É magic
- –î–æ–±–∞–≤–∏—Ç—å `AddTLSHeader()` ‚Äî –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ TLS record header
- –î–æ–±–∞–≤–∏—Ç—å `ParseTLSHeader()` ‚Äî –ø–∞—Ä—Å–∏–Ω–≥ TLS record header

**`/internal/crypto/crypto.go`:**
- –£–±—Ä–∞—Ç—å `GenerateKeyPair()` ‚Äî –±–æ–ª—å—à–µ –Ω–µ –Ω—É–∂–µ–Ω
- –£–±—Ä–∞—Ç—å `ComputeSharedSecret()` ‚Äî –±–æ–ª—å—à–µ –Ω–µ –Ω—É–∂–µ–Ω
- –ò–∑–º–µ–Ω–∏—Ç—å `DeriveSessionKeys()` ‚Äî –≤—ã–≤–æ–¥ –∏–∑ –ø–∞—Ä–æ–ª—è, –∞ –Ω–µ –∏–∑ ECDH
- –î–æ–±–∞–≤–∏—Ç—å `DeriveKeyFromPassword()` ‚Äî Argon2id(password, salt)

**`/internal/server/server.go`:**
- –ò–∑–º–µ–Ω–∏—Ç—å `handleHandshakeInit()` ‚Äî —É–ø—Ä–æ—â—ë–Ω–Ω—ã–π handshake
- –ò–∑–º–µ–Ω–∏—Ç—å `handleHandshakeResp()` ‚Äî —É–±—Ä–∞—Ç—å
- –ò–∑–º–µ–Ω–∏—Ç—å `handleHandshakeComplete()` ‚Äî —É–±—Ä–∞—Ç—å
- –ò–∑–º–µ–Ω–∏—Ç—å `sendKeepalives()` ‚Äî —Ä–∞–Ω–¥–æ–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∏–Ω—Ç–µ—Ä–≤–∞–ª
- –î–æ–±–∞–≤–∏—Ç—å `generateRandomPadding()` ‚Äî –≥–µ–Ω–µ—Ä–∞—Ü–∏—è padding
- –ò–∑–º–µ–Ω–∏—Ç—å `encryptDataPacket()` ‚Äî –¥–æ–±–∞–≤–∏—Ç—å padding –∏ TLS header
- –ò–∑–º–µ–Ω–∏—Ç—å `decryptDataPacket()` ‚Äî —É–±—Ä–∞—Ç—å TLS header, —É–±—Ä–∞—Ç—å padding

**`/config/config.go`:**
- –ò–∑–º–µ–Ω–∏—Ç—å `DefaultConfig()` ‚Äî –ø–æ—Ä—Ç 443 –≤–º–µ—Å—Ç–æ 51820
- –î–æ–±–∞–≤–∏—Ç—å –ø–æ–ª—è `ProtocolVersion`, `EnableTLSMasking`, `EnablePadding`

### 13.2. –ö–ª–∏–µ–Ω—Ç

**`/internal/protocol/protocol.go`:**
- –ê–Ω–∞–ª–æ–≥–∏—á–Ω–æ —Å–µ—Ä–≤–µ—Ä—É ‚Äî —É–±—Ä–∞—Ç—å magic, –¥–æ–±–∞–≤–∏—Ç—å padding, TLS header

**`/internal/crypto/crypto.go`:**
- –ê–Ω–∞–ª–æ–≥–∏—á–Ω–æ —Å–µ—Ä–≤–µ—Ä—É ‚Äî —É–ø—Ä–æ—â—ë–Ω–Ω–∞—è –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—è

**`/internal/vpnclient/client.go`:**
- –ò–∑–º–µ–Ω–∏—Ç—å `performHandshake()` ‚Äî —É–ø—Ä–æ—â—ë–Ω–Ω—ã–π handshake (2 –ø–∞–∫–µ—Ç–∞)
- –ò–∑–º–µ–Ω–∏—Ç—å `keepaliveLoop()` ‚Äî —Ä–∞–Ω–¥–æ–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∏–Ω—Ç–µ—Ä–≤–∞–ª
- –ò–∑–º–µ–Ω–∏—Ç—å `sendDataPacket()` ‚Äî –¥–æ–±–∞–≤–∏—Ç—å padding –∏ TLS header
- –ò–∑–º–µ–Ω–∏—Ç—å `receiveDataPacket()` ‚Äî —É–±—Ä–∞—Ç—å TLS header, —É–±—Ä–∞—Ç—å padding

### 13.3. –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

**`/configs/server.example.yaml`:**
```yaml
listen_port: 443
protocol_version: 2
enable_tls_masking: true
enable_padding: true
keepalive_interval: 25  # —Ä–∞–Ω–¥–æ–º–∏–∑–∏—Ä—É–µ—Ç—Å—è ¬±7 —Å–µ–∫
```

**`/configs/client.example.json`:**
```json
{
  "server_addr": "server.example.com:443",
  "protocol_version": 2,
  "enable_tls_masking": true,
  "enable_padding": true
}
```

---

## 14. –û—Ü–µ–Ω–∫–∞ —Ç—Ä—É–¥–æ–∑–∞—Ç—Ä–∞—Ç

| –ó–∞–¥–∞—á–∞ | –°–ª–æ–∂–Ω–æ—Å—Ç—å | –í—Ä–µ–º—è |
|--------|-----------|-------|
| –ò–∑–º–µ–Ω–µ–Ω–∏–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –ø–∞–∫–µ—Ç–∞ | –°—Ä–µ–¥–Ω—è—è | 4 —á–∞—Å–∞ |
| –£–ø—Ä–æ—â–µ–Ω–∏–µ –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏–∏ | –°—Ä–µ–¥–Ω—è—è | 6 —á–∞—Å–æ–≤ |
| –£–ø—Ä–æ—â–µ–Ω–∏–µ handshake | –ù–∏–∑–∫–∞—è | 3 —á–∞—Å–∞ |
| –î–æ–±–∞–≤–ª–µ–Ω–∏–µ padding | –ù–∏–∑–∫–∞—è | 2 —á–∞—Å–∞ |
| –î–æ–±–∞–≤–ª–µ–Ω–∏–µ TLS –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤ | –ù–∏–∑–∫–∞—è | 2 —á–∞—Å–∞ |
| –†–∞–Ω–¥–æ–º–∏–∑–∞—Ü–∏—è keepalive | –ù–∏–∑–∫–∞—è | 1 —á–∞—Å |
| –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ | –ù–∏–∑–∫–∞—è | 1 —á–∞—Å |
| –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ | –í—ã—Å–æ–∫–∞—è | 8 —á–∞—Å–æ–≤ |
| –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è | –°—Ä–µ–¥–Ω—è—è | 3 —á–∞—Å–∞ |
| **–ò–¢–û–ì–û** | | **30 —á–∞—Å–æ–≤** |

**–°—Ä–æ–∫ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏:** 4-5 —Ä–∞–±–æ—á–∏—Ö –¥–Ω–µ–π

---

## 15. –†–∏—Å–∫–∏

### 15.1. –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ —Ä–∏—Å–∫–∏

| –†–∏—Å–∫ | –í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å | –í–ª–∏—è–Ω–∏–µ | –ú–∏tig–∞—Ü–∏—è |
|------|-------------|---------|-----------|
| –ü—Ä–æ–±–ª–µ–º—ã —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏ | –°—Ä–µ–¥–Ω—è—è | –í—ã—Å–æ–∫–æ–µ | Dual-stack —Å–µ—Ä–≤–µ—Ä |
| –û—à–∏–±–∫–∏ –≤ —É–ø—Ä–æ—â—ë–Ω–Ω–æ–π –∫—Ä–∏–ø—Ç–æ | –ù–∏–∑–∫–∞—è | –ö—Ä–∏—Ç–∏—á–µ—Å–∫–æ–µ | Code review, –∞—É–¥–∏—Ç |
| –ü–∞–¥–µ–Ω–∏–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ | –ù–∏–∑–∫–∞—è | –°—Ä–µ–¥–Ω–µ–µ | –ë–µ–Ω—á–º–∞—Ä–∫–∏ –¥–æ/–ø–æ—Å–ª–µ |
| –ü—Ä–æ–±–ª–µ–º—ã —Å –ø–æ—Ä—Ç–æ–º 443 | –°—Ä–µ–¥–Ω—è—è | –°—Ä–µ–¥–Ω–µ–µ | –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–µ –ø–æ—Ä—Ç—ã |

### 15.2. –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

| –†–∏—Å–∫ | –í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å | –í–ª–∏—è–Ω–∏–µ | –ú–∏tig–∞—Ü–∏—è |
|------|-------------|---------|-----------|
| MITM –∞—Ç–∞–∫–∏ | –í—ã—Å–æ–∫–∞—è | –ö—Ä–∏—Ç–∏—á–µ—Å–∫–æ–µ | –°–∏–ª—å–Ω—ã–µ –ø–∞—Ä–æ–ª–∏, PSK |
| Brute-force –∞—Ç–∞–∫–∏ | –°—Ä–µ–¥–Ω—è—è | –í—ã—Å–æ–∫–æ–µ | Argon2id, rate limiting |
| Replay –∞—Ç–∞–∫–∏ | –ù–∏–∑–∫–∞—è | –°—Ä–µ–¥–Ω–µ–µ | Timestamp validation |
| –ö–æ–º–ø—Ä–æ–º–µ—Ç–∞—Ü–∏—è –ø–∞—Ä–æ–ª—è | –°—Ä–µ–¥–Ω—è—è | –ö—Ä–∏—Ç–∏—á–µ—Å–∫–æ–µ | –†–æ—Ç–∞—Ü–∏—è –ø–∞—Ä–æ–ª–µ–π |

### 15.3. –≠–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏—è

| –†–∏—Å–∫ | –í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å | –í–ª–∏—è–Ω–∏–µ | –ú–∏tig–∞—Ü–∏—è |
|------|-------------|---------|-----------|
| –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –ø–æ—Ä—Ç–∞ 443 | –ù–∏–∑–∫–∞—è | –ö—Ä–∏—Ç–∏—á–µ—Å–∫–æ–µ | –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–µ –ø–æ—Ä—Ç—ã |
| –ù–æ–≤—ã–µ DPI —Å–∏–≥–Ω–∞—Ç—É—Ä—ã | –°—Ä–µ–¥–Ω—è—è | –í—ã—Å–æ–∫–æ–µ | –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥, –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è |
| –ê–∫—Ç–∏–≤–Ω–æ–µ –∑–æ–Ω–¥–∏—Ä–æ–≤–∞–Ω–∏–µ | –°—Ä–µ–¥–Ω—è—è | –°—Ä–µ–¥–Ω–µ–µ | Rate limiting, silent drop |

---

## 16. –ú–µ—Ç—Ä–∏–∫–∏ —É—Å–ø–µ—Ö–∞

### 16.1. –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –º–µ—Ç—Ä–∏–∫–∏

- ‚úÖ **DPI detection rate < 1%** (—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ nDPI, Zeek, Suricata)
- ‚úÖ **Throughput >= 95%** –æ—Ç v1
- ‚úÖ **Latency handshake <= 70%** –æ—Ç v1
- ‚úÖ **Code complexity** —Å–Ω–∏–∂–µ–Ω–∞ –Ω–∞ 30%

### 16.2. –≠–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏–æ–Ω–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏

- ‚úÖ **Uptime >= 99.9%**
- ‚úÖ **Block rate < 0.1%** –≤ —Å—Ç—Ä–∞–Ω–∞—Ö —Å DPI (–º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥)
- ‚úÖ **Connection success rate >= 99%**
- ‚úÖ **Mean time to connect <= 500ms**

### 16.3. –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

- ‚úÖ **Zero known vulnerabilities** (CodeQL, code review)
- ‚úÖ **Password strength >= 100 bits entropy** (enforcement)
- ‚úÖ **Rate limiting** —Ä–∞–±–æ—Ç–∞–µ—Ç (max 10 attempts/min/IP)

---

**–î–∞—Ç–∞:** 2026-02-11  
**–í–µ—Ä—Å–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–∞:** 1.0  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ì–æ—Ç–æ–≤ –∫ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏  
**–°–ª–µ–¥—É—é—â–∏–π —à–∞–≥:** –ù–∞—á–∞—Ç—å –∏–º–ø–ª–µ–º–µ–Ω—Ç–∞—Ü–∏—é –∏–∑–º–µ–Ω–µ–Ω–∏–π –≤ `/internal/protocol/`
