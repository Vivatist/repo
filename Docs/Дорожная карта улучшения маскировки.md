# –î–æ—Ä–æ–∂–Ω–∞—è –∫–∞—Ä—Ç–∞ —É–ª—É—á—à–µ–Ω–∏—è –º–∞—Å–∫–∏—Ä–æ–≤–∫–∏ NovaVPN

> –î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è: 14.02.2026
> –°—Ç–∞—Ç—É—Å: –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏
> –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç: ü•á –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π (–º–∞—Å–∫–∏—Ä–æ–≤–∫–∞ ‚Äî –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç ‚Ññ1 –ø—Ä–æ–µ–∫—Ç–∞)

---

## –¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –º–∞—Å–∫–∏—Ä–æ–≤–∫–∏

### –ß—Ç–æ —É–∂–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ ‚úÖ

| –ú–µ—Ä–∞ | –û–ø–∏—Å–∞–Ω–∏–µ |
|------|----------|
| QUIC Short Header –æ–±—ë—Ä—Ç–∫–∞ | –ö–∞–∂–¥—ã–π –ø–∞–∫–µ—Ç –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å `0x40 \| random_6bits` + 4 random bytes |
| –ü–æ—Ä—Ç 443/UDP | –ò–º–∏—Ç–∞—Ü–∏—è QUIC-—Ç—Ä–∞—Ñ–∏–∫–∞ (—Å–æ–≤–ø–∞–¥–∞–µ—Ç —Å YouTube, Gmail, ...) |
| –û–±—Ñ—É—Å–∫–∞—Ü–∏—è –∑–∞–≥–æ–ª–æ–≤–∫–∞ | SessionID, Type, Counter –æ–±—Ñ—É—Å—Ü–∏—Ä–æ–≤–∞–Ω—ã XOR-–º–∞—Å–∫–æ–π –∏–∑ PSK |
| Padding keepalive/disconnect | 40-150 —Å–ª—É—á–∞–π–Ω—ã—Ö –±–∞–π—Ç (–Ω–µ—Ç —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ —Ä–∞–∑–º–µ—Ä–∞) |
| Padding data | –í—ã—Ä–∞–≤–Ω–∏–≤–∞–Ω–∏–µ 64B + random 0-32B –≤–Ω—É—Ç—Ä–∏ —à–∏—Ñ—Ä–æ—Ç–µ–∫—Å—Ç–∞ |
| Padding handshake | 100-400 —Å–ª—É—á–∞–π–Ω—ã—Ö –±–∞–π—Ç |
| –†–∞–Ω–¥–æ–º–∏–∑–∞—Ü–∏—è keepalive (–∫–ª–∏–µ–Ω—Ç) | 10‚Äì20 —Å–µ–∫—É–Ω–¥, `crypto/rand` |
| –†–∞–Ω–¥–æ–º–∏–∑–∞—Ü–∏—è keepalive (—Å–µ—Ä–≤–µ—Ä) | 18‚Äì32 —Å–µ–∫—É–Ω–¥, `crypto/rand` |
| –®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ payload –¥–∞–Ω–Ω—ã—Ö | ChaCha20 XOR ‚Äî high-entropy |
| AEAD –¥–ª—è handshake | ChaCha20-Poly1305 ‚Äî high-entropy |

### –ß—Ç–æ –æ–±–Ω–∞—Ä—É–∂–∏–≤–∞–µ—Ç—Å—è DPI ‚ùå

| # | –ü—Ä–æ–±–ª–µ–º–∞ | –°–µ—Ä—å—ë–∑–Ω–æ—Å—Ç—å | –û–ø–∏—Å–∞–Ω–∏–µ |
|---|----------|-------------|----------|
| 1 | **TLS Record –ø–æ–≤–µ—Ä—Ö UDP** | ‚úÖ –†–µ—à–µ–Ω–æ | –ó–∞–º–µ–Ω–µ–Ω–æ –Ω–∞ QUIC Short Header ‚Äî –ª–µ–≥–∏—Ç–∏–º–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç –¥–ª—è UDP:443 |
| 2 | **–ù–µ—Ç TLS Handshake** | ‚úÖ –ù–µ–∞–∫—Ç—É–∞–ª—å–Ω–æ | –ü—Ä–æ—Ç–æ–∫–æ–ª —Ç–µ–ø–µ—Ä—å –º–∞—Å–∫–∏—Ä—É–µ—Ç—Å—è –ø–æ–¥ QUIC, –∞ –Ω–µ TLS. QUIC Initial –Ω–µ –∏–º–∏—Ç–∏—Ä—É–µ—Ç—Å—è (—ç—Ç–∞–ø 4) |
| 1 | **–û—Ç–∫—Ä—ã—Ç—ã–π PacketType** | ‚úÖ –†–µ—à–µ–Ω–æ | –ë–∞–π—Ç Type –æ–±—Ñ—É—Å—Ü–∏—Ä–æ–≤–∞–Ω XOR-–º–∞—Å–∫–æ–π –∏–∑ PSK |
| 2 | **–û—Ç–∫—Ä—ã—Ç—ã–π SessionID** | ‚úÖ –†–µ—à–µ–Ω–æ | SessionID –æ–±—Ñ—É—Å—Ü–∏—Ä–æ–≤–∞–Ω XOR-–º–∞—Å–∫–æ–π + –≥–µ–Ω–µ—Ä–∞—Ü–∏—è —á–µ—Ä–µ–∑ `crypto/rand` |
| 3 | **–û—Ç–∫—Ä—ã—Ç—ã–π Counter** | ‚úÖ –†–µ—à–µ–Ω–æ | Counter –æ–±—Ñ—É—Å—Ü–∏—Ä–æ–≤–∞–Ω XOR-–º–∞—Å–∫–æ–π –∏–∑ PSK |
| 4 | **Error –ø–∞–∫–µ—Ç—ã ‚Äî –æ—Ç–∫—Ä—ã—Ç—ã–π —Ç–µ–∫—Å—Ç** | ‚úÖ –†–µ—à–µ–Ω–æ | Error-–ø–∞–∫–µ—Ç—ã —É–¥–∞–ª–µ–Ω—ã, –∑–∞–º–µ–Ω–µ–Ω—ã –Ω–∞ –º–æ–ª—á–∞–ª–∏–≤—ã–π drop |
| 7 | **Keepalive = 10 –±–∞–π—Ç** | ‚úÖ –†–µ—à–µ–Ω–æ | Padding 40-150 –±–∞–π—Ç, –Ω–µ—Ç —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ —Ä–∞–∑–º–µ—Ä–∞ |
| 8 | **HandshakeInit: SessionID=0, Nonce=0** | ‚úÖ –†–µ—à–µ–Ω–æ | –û–±—Ñ—É—Å–∫–∞—Ü–∏—è –∑–∞–≥–æ–ª–æ–≤–∫–∞ —Å–∫—Ä—ã–≤–∞–µ—Ç –Ω—É–ª–µ–≤–æ–π SID |
| 9 | **–ù–µ—Ç padding –¥–ª—è data** | ‚úÖ –†–µ—à–µ–Ω–æ | Padding –≤–Ω—É—Ç—Ä–∏ —à–∏—Ñ—Ä–æ—Ç–µ–∫—Å—Ç–∞ (align 64 + random 0-32) |
| 10 | **ServerPubKey –æ—Ç–∫—Ä—ã—Ç–æ** | üü° –°—Ä–µ–¥–Ω—è—è | –í HandshakeResp –ø–µ—Ä–≤—ã–µ 32 –±–∞–π—Ç–∞ payload ‚Äî raw Curve25519 public key –≤—Å–µ–≥–¥–∞ high-entropy, –Ω–æ —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ä–∞–∑–º–µ—Ä. |
| 11 | **–†–∞–∑–º–µ—Ä–Ω—ã–π fingerprint handshake** | ‚úÖ –†–µ—à–µ–Ω–æ | Padding 100-400 –±–∞–π—Ç –¥–ª—è handshake –ø–∞–∫–µ—Ç–æ–≤ |

---

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —É–ª—É—á—à–µ–Ω–∏–π

–í—Å–µ —É–ª—É—á—à–µ–Ω–∏—è —Ä–∞–∑–±–∏—Ç—ã –Ω–∞ 4 —ç—Ç–∞–ø–∞. –ö–∞–∂–¥—ã–π —ç—Ç–∞–ø —Å–∞–º–æ–¥–æ—Å—Ç–∞—Ç–æ—á–µ–Ω –∏ –º–æ–∂–µ—Ç –±—ã—Ç—å –∑–∞–¥–µ–ø–ª–æ–µ–Ω –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ. –≠—Ç–∞–ø—ã —É–ø–æ—Ä—è–¥–æ—á–µ–Ω—ã –ø–æ —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏—é ¬´—ç—Ñ—Ñ–µ–∫—Ç –º–∞—Å–∫–∏—Ä–æ–≤–∫–∏ / —Å–ª–æ–∂–Ω–æ—Å—Ç—å —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏¬ª.

---

## –≠—Ç–∞–ø 1: –®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–≥–æ–ª–æ–≤–∫–∞ (—É—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –æ—Ç–∫—Ä—ã—Ç—ã—Ö –ø–æ–ª–µ–π) ‚úÖ –†–ï–ê–õ–ò–ó–û–í–ê–ù

> –°–ª–æ–∂–Ω–æ—Å—Ç—å: —Å—Ä–µ–¥–Ω—è—è | –≠—Ñ—Ñ–µ–∫—Ç: üî¥üî¥üî¥ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π | –í–ª–∏—è–Ω–∏–µ –Ω–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å: –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ
> **–°—Ç–∞—Ç—É—Å: —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ** (—Å–µ—Ä–≤–µ—Ä, –∫–ª–∏–µ–Ω—Ç, –±–µ–Ω—á–º–∞—Ä–∫)

### 1.1. –û–±—Ñ—É—Å–∫–∞—Ü–∏—è SessionID + PacketType + Counter

**–ü—Ä–æ–±–ª–µ–º–∞:** SessionID (4B), PacketType (1B) –∏ Counter (4B) –ø–µ—Ä–µ–¥–∞—é—Ç—Å—è –æ—Ç–∫—Ä—ã—Ç–æ. –≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç DPI –∫–ª–∞—Å—Å–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å –ø–∞–∫–µ—Ç—ã, –∫–æ—Ä—Ä–µ–ª–∏—Ä–æ–≤–∞—Ç—å –ø–æ—Ç–æ–∫–∏ –∏ –æ—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å –æ–±—ä—ë–º –¥–∞–Ω–Ω—ã—Ö.

**–†–µ—à–µ–Ω–∏–µ:** XOR-–æ–±—Ñ—É—Å–∫–∞—Ü–∏—è header-–±–ª–æ–∫–∞ –∫–ª—é—á–æ–º, –ø—Ä–æ–∏–∑–≤–æ–¥–Ω—ã–º –æ—Ç PSK.

```
header_mask = HMAC-SHA256(PSK, "nova-header-mask")[:9]   // 9 –±–∞–π—Ç –º–∞—Å–∫–∞

// –û—Ç–ø—Ä–∞–≤–∫–∞ (–ø–æ—Å–ª–µ QUIC header):
raw[0:4] = SessionID XOR header_mask[0:4]
raw[4]   = PacketType XOR header_mask[4]
raw[5:9] = Counter XOR header_mask[5:9]    // —Ç–æ–ª—å–∫–æ –¥–ª—è data-–ø–∞–∫–µ—Ç–æ–≤

// –ü—Ä–∏—ë–º ‚Äî —Ç–∞ –∂–µ –æ–ø–µ—Ä–∞—Ü–∏—è (XOR –æ–±—Ä–∞—Ç–∏–º):
SessionID = raw[0:4] XOR header_mask[0:4]
PacketType = raw[4] XOR header_mask[4]
```

**–ù—é–∞–Ω—Å:** –°–µ—Ä–≤–µ—Ä –¥–æ–ª–∂–µ–Ω –ø—Ä–æ–±–æ–≤–∞—Ç—å –¥–µ–æ–±—Ñ—É—Å–∫–∞—Ü–∏—é —Å PSK. –î–ª—è HandshakeInit (SessionID=0, zero PSK –ø—Ä–∏ bootstrap) ‚Äî –º–∞—Å–∫–∞ –∏–∑ –Ω—É–ª–µ–≤–æ–≥–æ –∫–ª—é—á–∞.

**–§–∞–π–ª—ã –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è:**
- `vpn-server/internal/protocol/packet.go` ‚Äî `AddTLSHeader`, `Marshal`, `Unmarshal`
- `vpn-server/internal/server/server.go` ‚Äî `processUDPPacket` (—Å–Ω–∞—á–∞–ª–∞ –¥–µ–æ–±—Ñ—É—Å–∫–∞—Ü–∏—è)
- `vpn-client-windows/internal/protocol/protocol.go` ‚Äî –∞–Ω–∞–ª–æ–≥–∏—á–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è
- `vpn-client-windows/internal/infrastructure/vpn/client.go` ‚Äî –æ—Ç–ø—Ä–∞–≤–∫–∞ data/keepalive
- `vpn-server/cmd/vpnbench/` ‚Äî –æ–±–Ω–æ–≤–∏—Ç—å –∫–ª–∏–µ–Ω—Ç –±–µ–Ω—á–º–∞—Ä–∫–∞

**–ú–µ—Ç—Ä–∏–∫–∞:** 1 HMAC-SHA256 –ø—Ä–∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ —Å–µ—Å—Å–∏–∏ (–Ω–µ –Ω–∞ –∫–∞–∂–¥—ã–π –ø–∞–∫–µ—Ç) + XOR 9 –±–∞–π—Ç –Ω–∞ –∫–∞–∂–¥—ã–π –ø–∞–∫–µ—Ç ‚âà +5 –Ω—Å/–ø–∞–∫–µ—Ç.

### 1.2. –†–∞–Ω–¥–æ–º–∏–∑–∞—Ü–∏—è SessionID

**–ü—Ä–æ–±–ª–µ–º–∞:** `nextSessionID.Add(1)` ‚Äî –∏–Ω–∫—Ä–µ–º–µ–Ω—Ç–∞–ª—å–Ω—ã–π. DPI –≤–∏–¥–∏—Ç –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω—ã–µ ID –∏ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–ª–∏–µ–Ω—Ç–æ–≤.

**–†–µ—à–µ–Ω–∏–µ:** `crypto/rand` –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ 4-–±–∞–π—Ç–Ω–æ–≥–æ SessionID —Å –ø—Ä–æ–≤–µ—Ä–∫–æ–π —É–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç–∏ –≤ `SessionManager`.

**–§–∞–π–ª—ã –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è:**
- `vpn-server/internal/server/session.go` ‚Äî `CreateSession`

### 1.3. –®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ Error-–ø–∞–∫–µ—Ç–æ–≤

**–ü—Ä–æ–±–ª–µ–º–∞:** Error-–ø–∞–∫–µ—Ç—ã —Å–æ–¥–µ—Ä–∂–∞—Ç –æ—Ç–∫—Ä—ã—Ç—ã–π ASCII —Ç–µ–∫—Å—Ç (`"auth_failed"`).

**–†–µ—à–µ–Ω–∏–µ:** –î–≤–∞ –≤–∞—Ä–∏–∞–Ω—Ç–∞ (–æ—Ç –ø—Ä–æ—Å—Ç–æ–≥–æ –∫ –ª—É—á—à–µ–º—É):
- **–í–∞—Ä–∏–∞–Ω—Ç A:** –£–±—Ä–∞—Ç—å Error-–ø–∞–∫–µ—Ç—ã –ø–æ–ª–Ω–æ—Å—Ç—å—é ‚Äî –º–æ–ª—á–∞–ª–∏–≤—ã–π drop (–∫–∞–∫ –ø—Ä–∏ –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω–æ–º HMAC)
- **–í–∞—Ä–∏–∞–Ω—Ç B:** –®–∏—Ñ—Ä–æ–≤–∞—Ç—å Error payload —á–µ—Ä–µ–∑ ChaCha20-Poly1305 —Å PSK

–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è: **–í–∞—Ä–∏–∞–Ω—Ç A** ‚Äî –ø—Ä–æ—â–µ, –±–µ–∑–æ–ø–∞—Å–Ω–µ–µ, –ª—É—á—à–µ –¥–ª—è –º–∞—Å–∫–∏—Ä–æ–≤–∫–∏ (–º–µ–Ω—å—à–µ —Ç—Ä–∞—Ñ–∏–∫–∞ = –º–µ–Ω—å—à–µ fingerprint). –ö–ª–∏–µ–Ω—Ç —É–∂–µ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç —Ç–∞–π–º–∞—É—Ç—ã.

**–§–∞–π–ª—ã –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è:**
- `vpn-server/internal/server/handler.go` ‚Äî `sendErrorPacket` ‚Üí —É–¥–∞–ª–∏—Ç—å –∏–ª–∏ —à–∏—Ñ—Ä–æ–≤–∞—Ç—å
- `vpn-client-windows/internal/infrastructure/vpn/handshake/performer.go` ‚Äî –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

---

## –≠—Ç–∞–ø 2: Padding (—É—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–Ω—ã—Ö —Å–∏–≥–Ω–∞—Ç—É—Ä) ‚Äî ‚úÖ –†–ï–ê–õ–ò–ó–û–í–ê–ù–û

> –°–ª–æ–∂–Ω–æ—Å—Ç—å: —Å—Ä–µ–¥–Ω—è—è | –≠—Ñ—Ñ–µ–∫—Ç: üü†üü† –≤—ã—Å–æ–∫–∏–π | –í–ª–∏—è–Ω–∏–µ –Ω–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å: +2‚Äì5% overhead —Ç—Ä–∞—Ñ–∏–∫–∞

### 2.1. Padding Keepalive/Disconnect ‚Äî ‚úÖ

**–ü—Ä–æ–±–ª–µ–º–∞:** –§–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ä–∞–∑–º–µ—Ä 10 –±–∞–π—Ç ‚Äî —É–Ω–∏–∫–∞–ª—å–Ω–∞—è —Å–∏–≥–Ω–∞—Ç—É—Ä–∞. –í TLS —Ç–∞–∫–æ–π –º–∞–ª–µ–Ω—å–∫–∏–π record –Ω–µ–≤–æ–∑–º–æ–∂–µ–Ω.

**–†–µ—à–µ–Ω–∏–µ:** –°–ª—É—á–∞–π–Ω—ã–π padding 40‚Äì150 –±–∞–π—Ç –ø–æ—Å–ª–µ SID+Type. –ü–æ–ª—É—á–∞—Ç–µ–ª—å –∏–≥–Ω–æ—Ä–∏—Ä—É–µ—Ç –≤—Å—ë –ø–æ—Å–ª–µ SID+Type.

```
// Wire format: QUIC(5) + SID(4) + Type(1) + RandomPad(40-150) = 50-160 –±–∞–π—Ç
// PadLen –ø–æ–ª–µ –ù–ï –Ω—É–∂–Ω–æ ‚Äî –ø–æ–ª—É—á–∞—Ç–µ–ª—å –ø–∞—Ä—Å–∏—Ç —Ç–æ–ª—å–∫–æ SID+Type
```

**–ò–∑–º–µ–Ω—ë–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã:**
- `vpn-server/internal/protocol/crypto.go` ‚Äî –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã `KeepalivePadMin=40`, `KeepalivePadMax=150`, —Ñ—É–Ω–∫—Ü–∏—è `RandomPadLen()`
- `vpn-server/internal/server/server.go` ‚Äî inline keepalive –æ—Ç–≤–µ—Ç, `sendKeepalives()`, `notifyShutdown()`
- `vpn-client-windows/internal/infrastructure/vpn/client.go` ‚Äî `keepaliveLoop()`, `Disconnect()`, `tryResume()`
- `vpn-server/cmd/vpnbench/client.go` ‚Äî `buildKeepalive()`, `disconnect()`

### 2.2. Padding Data-–ø–∞–∫–µ—Ç–æ–≤ ‚Äî ‚úÖ

**–ü—Ä–æ–±–ª–µ–º–∞:** –†–∞–∑–º–µ—Ä data-–ø–∞–∫–µ—Ç–∞ = —Ç–æ—á–Ω–∞—è –¥–ª–∏–Ω–∞ IP-–ø–∞–∫–µ—Ç–∞ + 14 –±–∞–π—Ç. –ü–æ–∑–≤–æ–ª—è–µ—Ç traffic analysis.

**–†–µ—à–µ–Ω–∏–µ:** Padding **–≤–Ω—É—Ç—Ä–∏** —à–∏—Ñ—Ä–æ—Ç–µ–∫—Å—Ç–∞. `plaintext + zeros(padLen) + byte(padLen)` ‚Äî –Ω—É–ª–∏ –ø–æ—Å–ª–µ XOR —Å ChaCha20 keystream –≤—ã–≥–ª—è–¥—è—Ç –∫–∞–∫ random (raw keystream). –ù–µ —Ç—Ä–µ–±—É–µ—Ç `crypto/rand` –≤ hot path.

```
padLen = DataPadAlign(64) - (plaintextLen % 64) + random(0, DataPadRandomMax(32)), cap 255
paddedPlaintext = plaintext + zeros(padLen) + byte(padLen)
ciphertext = ChaCha20_XOR(paddedPlaintext)  // –µ–¥–∏–Ω—ã–π keystream
// –ü—Ä–∏—ë–º: decrypt ‚Üí last byte = padLen ‚Üí actualLen = totalLen - 1 - padLen
```

**–ò–∑–º–µ–Ω—ë–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã:**
- `vpn-server/internal/protocol/crypto.go` ‚Äî `ComputeDataPadLen()`, –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã `DataPadAlign=64`, `DataPadRandomMax=32`
- `vpn-server/internal/server/session.go` ‚Äî `EncryptAndBuild()` —Å padding
- `vpn-server/internal/server/server.go` ‚Äî `processUDPPacket()` —Å–Ω—è—Ç–∏–µ padding
- `vpn-client-windows/internal/infrastructure/crypto/session.go` ‚Äî `EncryptInto()` —Å padding, `DecryptWithCounter()` —Å–Ω—è—Ç–∏–µ padding
- `vpn-server/cmd/vpnbench/client.go` ‚Äî `buildDataPacket()`, `runThroughputTest()` —Å padding

### 2.3. Padding Handshake-–ø–∞–∫–µ—Ç–æ–≤ ‚Äî ‚úÖ

**–ü—Ä–æ–±–ª–µ–º–∞:** HandshakeInit ~170‚Äì200 –±–∞–π—Ç, HandshakeResp ~190‚Äì220 –±–∞–π—Ç ‚Äî —Ñ–∏–∫—Å–∏—Ä—É–µ–º—ã–µ —Ä–∞–∑–º–µ—Ä—ã.

**–†–µ—à–µ–Ω–∏–µ:** Random padding 100‚Äì400 –±–∞–π—Ç. –î–ª—è Init/Complete ‚Äî –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è –∫ payload –ø–µ—Ä–µ–¥ –ø–µ—Ä–µ–¥–∞—á–µ–π (–ø–∞—Ä—Å–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç length fields). –î–ª—è Resp ‚Äî –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è –∫ respData –¥–æ AEAD-—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è (–ø–∞—Ä—Å–µ—Ä —á–∏—Ç–∞–µ—Ç —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Å–º–µ—â–µ–Ω–∏—è).

**–ò–∑–º–µ–Ω—ë–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã:**
- `vpn-server/internal/server/handler.go` ‚Äî `handleHandshakeInit()` padding respData –ø–µ—Ä–µ–¥ Encrypt
- `vpn-client-windows/internal/infrastructure/vpn/handshake/performer.go` ‚Äî `sendHandshakeInit()`, `sendHandshakeComplete()` padding payload
- `vpn-server/cmd/vpnbench/client.go` ‚Äî padding –≤ `doHandshake()` –¥–ª—è Init –∏ Complete

---

## –≠—Ç–∞–ø 3: QUIC-–ø–æ–¥–æ–±–Ω–∞—è –æ–±—Ñ—É—Å–∫–∞—Ü–∏—è (—É—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–æ—Ç–æ–∫–æ–ª—å–Ω–æ–π –∞–Ω–æ–º–∞–ª–∏–∏) ‚úÖ –†–ï–ê–õ–ò–ó–û–í–ê–ù

> –°–ª–æ–∂–Ω–æ—Å—Ç—å: –≤—ã—Å–æ–∫–∞—è | –≠—Ñ—Ñ–µ–∫—Ç: üî¥üî¥üî¥ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π | –í–ª–∏—è–Ω–∏–µ –Ω–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å: –Ω—É–ª–µ–≤–æ–µ
> **–°—Ç–∞—Ç—É—Å: —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ** (—Å–µ—Ä–≤–µ—Ä, –∫–ª–∏–µ–Ω—Ç, –±–µ–Ω—á–º–∞—Ä–∫, –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è)

### 3.1. –ü—Ä–æ–±–ª–µ–º–∞ TLS-over-UDP

–¢–µ–∫—É—â–∏–π –∑–∞–≥–æ–ª–æ–≤–æ–∫ `0x17 0x03 0x03` ‚Äî —Ñ–æ—Ä–º–∞—Ç TLS Record Layer, –∫–æ—Ç–æ—Ä—ã–π —Ä–∞–±–æ—Ç–∞–µ—Ç **—Ç–æ–ª—å–∫–æ –ø–æ TCP**. –ü–æ UDP:443 —Ö–æ–¥—è—Ç:
- **QUIC** (Chrome, Firefox) ‚Äî –∏–º–µ–µ—Ç —Å–≤–æ–π –∑–∞–≥–æ–ª–æ–≤–æ–∫ (QUIC Initial, QUIC Short Header)
- **DTLS** ‚Äî –∏–º–µ–µ—Ç —Å–≤–æ–π –∑–∞–≥–æ–ª–æ–≤–æ–∫ (ContentType + Epoch + SequenceNumber)

DPI, –≤–∏–¥—è TLS Record Layer –ø–æ UDP, –º–≥–Ω–æ–≤–µ–Ω–Ω–æ –ø–æ–Ω–∏–º–∞–µ—Ç, —á—Ç–æ —ç—Ç–æ –Ω–µ –ª–µ–≥–∏—Ç–∏–º–Ω—ã–π –ø—Ä–æ—Ç–æ–∫–æ–ª.

### 3.2. –í–∞—Ä–∏–∞–Ω—Ç—ã —Ä–µ—à–µ–Ω–∏—è

#### –í–∞—Ä–∏–∞–Ω—Ç A: –ú–∞—Å–∫–∏—Ä–æ–≤–∫–∞ –ø–æ–¥ QUIC (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–π)

QUIC ‚Äî —Å–∞–º—ã–π –ø–æ–ø—É–ª—è—Ä–Ω—ã–π –ø—Ä–æ—Ç–æ–∫–æ–ª –Ω–∞ UDP:443. –ú–∞—Å–∫–∏—Ä–æ–≤–∫–∞ –ø–æ–¥ QUIC Short Header:

```
QUIC Short Header (—Ä–µ–∞–ª—å–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç):
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ 0 1  ‚îÇ Destination Conn ID ‚îÇ Encrypted Payload  ‚îÇ
‚îÇ Flags‚îÇ      0-20 –±–∞–π—Ç      ‚îÇ                    ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò

–ü–µ—Ä–≤—ã–π –±–∏—Ç = 0 (Short Header), —Å–ª–µ–¥—É—é—â–∏–µ –±–∏—Ç—ã = flags.
```

–ù–∞—à –ø—Ä–æ—Ç–æ–∫–æ–ª –º–æ–∂–µ—Ç –∏–º–∏—Ç–∏—Ä–æ–≤–∞—Ç—å QUIC Short Header:
```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ Flags‚îÇ Connection ID (4-8B)‚îÇ Obfuscated Packet Data     ‚îÇ
‚îÇ  1B  ‚îÇ  = SessionID        ‚îÇ = Type + Counter + Payload ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

- `Flags`: —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç—Å—è –∫–∞–∫ –≤–∞–ª–∏–¥–Ω—ã–µ QUIC flags (Header Form=0, Fixed Bit=1, ...)
- `Connection ID`: –Ω–∞—à SessionID (QUIC Connection ID = 0‚Äì20 –±–∞–π—Ç, 4 –±–∞–π—Ç–∞ ‚Äî –≤–∞–ª–∏–¥–Ω–æ)
- –û—Å—Ç–∞–ª—å–Ω–æ–µ: –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–æ/–æ–±—Ñ—É—Å—Ü–∏—Ä–æ–≤–∞–Ω–æ

**–ü–ª—é—Å—ã:** QUIC ‚Äî –ª–µ–≥–∏—Ç–∏–º–Ω—ã–π UDP:443 —Ç—Ä–∞—Ñ–∏–∫, DPI –Ω–µ –±–ª–æ–∫–∏—Ä—É–µ—Ç (–∏–Ω–∞—á–µ —Å–ª–æ–º–∞–µ—Ç—Å—è YouTube, Gmail, ..)
**–ú–∏–Ω—É—Å—ã:** –ù—É–∂–Ω–æ —á–∞—Å—Ç–∏—á–Ω–æ –∏–º–∏—Ç–∏—Ä–æ–≤–∞—Ç—å QUIC Initial (–¥–ª—è –ø–µ—Ä–≤–æ–≥–æ –ø–∞–∫–µ—Ç–∞), —Å–ª–æ–∂–Ω–µ–µ –ø–∞—Ä—Å–∏–Ω–≥

#### –í–∞—Ä–∏–∞–Ω—Ç B: –ú–∞—Å–∫–∏—Ä–æ–≤–∫–∞ –ø–æ–¥ DTLS

DTLS 1.2 Record Layer:
```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ Content Type ‚îÇ  Version‚îÇ  Epoch  ‚îÇ Seq Num  ‚îÇ Length + Payload ‚îÇ
‚îÇ     1B       ‚îÇ   2B    ‚îÇ   2B    ‚îÇ   6B     ‚îÇ   2B + var      ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

**–ü–ª—é—Å—ã:** –ü—Ä–æ—â–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å (–∑–∞–º–µ–Ω—è–µ–º —Ç–æ–ª—å–∫–æ –∑–∞–≥–æ–ª–æ–≤–æ–∫), –ª–µ–≥–∏—Ç–∏–º–Ω—ã–π UDP+TLS –ø—Ä–æ—Ç–æ–∫–æ–ª (WebRTC, VoIP)
**–ú–∏–Ω—É—Å—ã:** DTLS –º–µ–Ω–µ–µ —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω—ë–Ω —á–µ–º QUIC, –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ DPI –º–æ–≥—É—Ç –∏–Ω—Å–ø–µ–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –¥–µ—Ç–∞–ª—å–Ω–µ–µ

#### –í–∞—Ä–∏–∞–Ω—Ç C: –ü–æ–ª–Ω–æ—Å—Ç—å—é –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã–π –∑–∞–≥–æ–ª–æ–≤–æ–∫ (random bytes)

–í–º–µ—Å—Ç–æ –ª—é–±–æ–≥–æ —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–µ–º–æ–≥–æ —Ñ–æ—Ä–º–∞—Ç–∞ ‚Äî –ø–æ–ª–Ω–æ—Å—Ç—å—é —Å–ª—É—á–∞–π–Ω—ã–µ –±–∞–π—Ç—ã:
```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  Fully encrypted/random looking data      ‚îÇ
‚îÇ  (no recognizable header at all)          ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

–°–µ—Ä–≤–µ—Ä –≤—ã—á–∏—Å–ª—è–µ—Ç `header_key = HKDF(PSK, "nova-header")` –∏ –ø—Ä–æ–±—É–µ—Ç —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∞—Ç—å –ø–µ—Ä–≤—ã–µ N –±–∞–π—Ç –∫–∞–∂–¥–æ–≥–æ –ø–∞–∫–µ—Ç–∞.

**–ü–ª—é—Å—ã:** –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å –∫ DPI ‚Äî –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –ø—Ä–æ—Ç–æ–∫–æ–ª
**–ú–∏–Ω—É—Å—ã:** –°–µ—Ä–≤–µ—Ä –Ω–µ –º–æ–∂–µ—Ç –±—ã—Å—Ç—Ä–æ –æ—Ç—Å–µ—è—Ç—å –º—É—Å–æ—Ä–Ω—ã–µ –ø–∞–∫–µ—Ç—ã, –º–æ–∂–µ—Ç –±—ã—Ç—å –∞—Ç–∞–∫–æ–≤–∞–Ω UDP-—Ñ–ª—É–¥–æ–º

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –í–∞—Ä–∏–∞–Ω—Ç A (QUIC) –¥–ª—è –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π –º–∞—Å–∫–∏—Ä–æ–≤–∫–∏ —Å –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–º —Ä–∏—Å–∫–æ–º –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏. –í–∞—Ä–∏–∞–Ω—Ç C –∫–∞–∫ fallback –¥–ª—è –ø—Ä–æ–¥–≤–∏–Ω—É—Ç–æ–≥–æ DPI.

### 3.3. –†–µ–∞–ª–∏–∑–∞—Ü–∏—è (–í–∞—Ä–∏–∞–Ω—Ç A ‚Äî QUIC Short Header) ‚úÖ

**–†–µ—à–µ–Ω–∏–µ:** –ó–∞–º–µ–Ω—ë–Ω TLS Record Header (5 –±–∞–π—Ç) –Ω–∞ QUIC Short Header (5 –±–∞–π—Ç) ‚Äî —Ç–æ—Ç –∂–µ —Ä–∞–∑–º–µ—Ä, –≤—Å–µ —Å–º–µ—â–µ–Ω–∏—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã.

```
QUIC Short Header (NovaVPN v3):
Byte 0:   0x40 | crypto/rand(6 bits)   ‚Äî –≤–∞–ª–∏–¥–Ω—ã–π QUIC Short Header flags
Bytes 1-4: crypto/rand(4 bytes)       ‚Äî –∏–º–∏—Ç–∏—Ä—É–µ—Ç DCID-–ø–æ–¥–æ–±–Ω—É—é –æ–±–ª–∞—Å—Ç—å
```

- –ö–∞–∂–¥—ã–π –ø–∞–∫–µ—Ç –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç **–Ω–æ–≤—ã–µ —Å–ª—É—á–∞–π–Ω—ã–µ** flags –∏ pad bytes (–Ω–µ—Ç –ø–∞—Ç—Ç–µ—Ä–Ω–∞)
- **–ù–µ—Ç –ø–æ–ª—è –¥–ª–∏–Ω—ã** (UDP-–¥–∞—Ç–∞–≥—Ä–∞–º–º–∞ = —Ç–æ—á–Ω—ã–π —Ä–∞–∑–º–µ—Ä)
- –í—Å–µ —Å–º–µ—â–µ–Ω–∏—è –ø–æ—Å–ª–µ –∑–∞–≥–æ–ª–æ–≤–∫–∞ –∏–¥–µ–Ω—Ç–∏—á–Ω—ã v2: SID –Ω–∞ [5:9], Type –Ω–∞ [9], Counter –Ω–∞ [10:14]
- ProtocolVersion –ø–æ–≤—ã—à–µ–Ω —Å `0x02` –¥–æ `0x03`
- `WriteQUICHeader(buf)` / `SkipHeader(data)` ‚Äî –Ω–æ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
- `AddTLSHeader` / `ParseTLSHeader` ‚Äî –æ—Å—Ç–∞–≤–ª–µ–Ω—ã –∫–∞–∫ deprecated-–æ–±—ë—Ä—Ç–∫–∏

**–ò–∑–º–µ–Ω—ë–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã:**
- `vpn-server/internal/protocol/packet.go` ‚Äî –Ω–æ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏, –æ–±–Ω–æ–≤–ª—ë–Ω Marshal/Unmarshal
- `vpn-server/internal/protocol/crypto.go` ‚Äî –æ–±–Ω–æ–≤–ª–µ–Ω—ã –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ (TLS‚ÜíQUIC)
- `vpn-server/internal/server/session.go` ‚Äî `EncryptAndBuild()` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `WriteQUICHeader()`
- `vpn-server/internal/server/server.go` ‚Äî –≤—Å–µ –∏–Ω–ª–∞–π–Ω-–∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –∑–∞–º–µ–Ω–µ–Ω—ã
- `vpn-server/internal/server/handler.go` ‚Äî –≤—Å–µ –∏–Ω–ª–∞–π–Ω-–∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –∑–∞–º–µ–Ω–µ–Ω—ã
- `vpn-client-windows/internal/protocol/protocol.go` ‚Äî –∞–Ω–∞–ª–æ–≥–∏—á–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è
- `vpn-client-windows/internal/infrastructure/vpn/client.go` ‚Äî –≤—Å–µ –æ—Ç–ø—Ä–∞–≤–∫–∏/–ø—Ä–∏—ë–º
- `vpn-client-windows/internal/infrastructure/vpn/handshake/performer.go` ‚Äî handshake
- `vpn-client-windows/internal/infrastructure/crypto/session.go` ‚Äî –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏
- `vpn-server/cmd/vpnbench/client.go` ‚Äî –±–µ–Ω—á–º–∞—Ä–∫ –∫–ª–∏–µ–Ω—Ç
- `vpn-server/cmd/vpnbench/stress.go` ‚Äî stress-—Ç–µ—Å—Ç —Å –¥–µ–æ–±—Ñ—É—Å–∫–∞—Ü–∏–µ–π

**–ú–µ—Ç—Ä–∏–∫–∞:** WriteQUICHeader = 5 –±–∞–π—Ç crypto/rand –Ω–∞ –ø–∞–∫–µ—Ç (~50 –Ω—Å). –î–ª—è data hot path (EncryptAndBuild) ‚Äî –ø—Ä–∏–Ω—è—Ç—ã–π overhead.

---

## –≠—Ç–∞–ø 4: –ò–º–∏—Ç–∞—Ü–∏—è TLS Handshake (–¥–ª—è TCP-fallback)

> –°–ª–æ–∂–Ω–æ—Å—Ç—å: –æ—á–µ–Ω—å –≤—ã—Å–æ–∫–∞—è | –≠—Ñ—Ñ–µ–∫—Ç: üü° —Å—Ä–µ–¥–Ω–∏–π (–∞–∫—Ç—É–∞–ª—å–Ω–æ —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ TCP) | –ù–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π

### 4.1. –û–ø–∏—Å–∞–Ω–∏–µ

–ï—Å–ª–∏ –≤ –±—É–¥—É—â–µ–º –±—É–¥–µ—Ç TCP-—Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç, –Ω—É–∂–Ω–∞ –∏–º–∏—Ç–∞—Ü–∏—è –ø–æ–ª–Ω–æ–≥–æ TLS 1.3 handshake:
- Client Hello —Å —Ä–µ–∞–ª—å–Ω—ã–º–∏ TLS extensions (SNI, ALPN, ...)
- Server Hello —Å Certificate (–ø–æ–¥–¥–µ–ª—å–Ω—ã–º –∏–ª–∏ Let's Encrypt)
- –î–∞–ª—å–Ω–µ–π—à–∏–π —Ç—Ä–∞—Ñ–∏–∫ ‚Äî –∫–∞–∫ –Ω–∞—Å—Ç–æ—è—â–∏–π TLS Application Data

–≠—Ç–æ –∞–Ω–∞–ª–æ–≥ —Ç–æ–≥–æ, —á—Ç–æ –¥–µ–ª–∞—é—Ç **V2Ray/VMess**, **Trojan-GFW**, **Shadowsocks-AEAD —Å –ø–ª–∞–≥–∏–Ω–∞–º–∏**.

### 4.2. –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

- –î–æ–º–µ–Ω–Ω–æ–µ –∏–º—è –¥–ª—è SNI (–º–æ–∂–Ω–æ –∑–∞—Ö–∞—Ä–¥–∫–æ–¥–∏—Ç—å –ø–æ–ø—É–ª—è—Ä–Ω—ã–π CDN –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å domain fronting)
- TLS-—Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç (Let's Encrypt –∏–ª–∏ —Å–∞–º–æ–ø–æ–¥–ø–∏—Å–∞–Ω–Ω—ã–π)
- –ü–æ–ª–Ω—ã–π TLS state machine –Ω–∞ –∫–ª–∏–µ–Ω—Ç–µ –∏ —Å–µ—Ä–≤–µ—Ä–µ

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –û—Ç–ª–æ–∂–∏—Ç—å –¥–æ –ø–æ—è–≤–ª–µ–Ω–∏—è —Ä–µ–∞–ª—å–Ω–æ–π –ø–æ—Ç—Ä–µ–±–Ω–æ—Å—Ç–∏ (TCP-—Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç). –î–ª—è UDP —Ç–µ–∫—É—â–∏–π –≠—Ç–∞–ø 3 (QUIC-–æ–±—Ñ—É—Å–∫–∞—Ü–∏—è) –ø–æ–ª–Ω–æ—Å—Ç—å—é –¥–æ—Å—Ç–∞—Ç–æ—á–µ–Ω.

---

## –°–≤–æ–¥–∫–∞ —ç—Ç–∞–ø–æ–≤

| –≠—Ç–∞–ø | –ù–∞–∑–≤–∞–Ω–∏–µ | –°–ª–æ–∂–Ω–æ—Å—Ç—å | –≠—Ñ—Ñ–µ–∫—Ç | –û–ø–∏—Å–∞–Ω–∏–µ |
|------|----------|-----------|--------|----------|
| **1** | –®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–≥–æ–ª–æ–≤–∫–∞ | –°—Ä–µ–¥–Ω—è—è | üî¥üî¥üî¥ | ‚úÖ XOR-–æ–±—Ñ—É—Å–∫–∞—Ü–∏—è SID+Type+Counter, —Ä–∞–Ω–¥–æ–º SID, —É–±—Ä–∞–Ω—ã Error-–ø–∞–∫–µ—Ç—ã |
| **2** | Padding | –°—Ä–µ–¥–Ω—è—è | üü†üü† | ‚úÖ Padding keepalive (40-150B), data (align 64 + rand 0-32, –≤–Ω—É—Ç—Ä–∏ CT), handshake (100-400B) |
| **3** | QUIC-–æ–±—Ñ—É—Å–∫–∞—Ü–∏—è | –í—ã—Å–æ–∫–∞—è | üî¥üî¥üî¥ | ‚úÖ QUIC Short Header (5B random) –≤–º–µ—Å—Ç–æ TLS Record Header. –ü—Ä–æ—Ç–æ–∫–æ–ª v3 |
| **4** | TLS Handshake | –û—á–µ–Ω—å –≤—ã—Å–æ–∫–∞—è | üü° | –ò–º–∏—Ç–∞—Ü–∏—è –ø–æ–ª–Ω–æ–≥–æ TLS 1.3 –¥–ª—è TCP-fallback (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π) |

---

## –ü–æ—Ä—è–¥–æ–∫ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

```
–≠—Ç–∞–ø 1 (–∑–∞–≥–æ–ª–æ–≤–æ–∫) ‚úÖ ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñ∫ –≠—Ç–∞–ø 2 (padding) ‚úÖ ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñ∫ –≠—Ç–∞–ø 3 (QUIC) ‚úÖ
     –∑–∞–≤–µ—Ä—à—ë–Ω                    –∑–∞–≤–µ—Ä—à—ë–Ω                  –∑–∞–≤–µ—Ä—à—ë–Ω
```

–≠—Ç–∞–ø—ã 1 –∏ 2 –º–æ–≥—É—Ç –∏–¥—Ç–∏ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ. –≠—Ç–∞–ø 3 —Ç—Ä–µ–±—É–µ—Ç –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –≠—Ç–∞–ø–∞ 1 (—Ç.–∫. –º–µ–Ω—è–µ—Ç—Å—è –≤–µ—Å—å —Ñ–æ—Ä–º–∞—Ç –∑–∞–≥–æ–ª–æ–≤–∫–∞). –≠—Ç–∞–ø 4 ‚Äî –æ—Ç–¥–µ–ª—å–Ω—ã–π –ø—Ä–æ–µ–∫—Ç.

---

## –í–ª–∏—è–Ω–∏–µ –Ω–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

| –ò–∑–º–µ–Ω–µ–Ω–∏–µ | Overhead CPU | Overhead —Ç—Ä–∞—Ñ–∏–∫–∞ | –í–ª–∏—è–Ω–∏–µ –Ω–∞ RTT |
|-----------|-------------|-----------------|----------------|
| XOR header (9B) | +5 –Ω—Å/–ø–∞–∫–µ—Ç | 0% | 0 |
| Random SessionID | ‚âà0 (—Ç–æ–ª—å–∫–æ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏) | 0% | 0 |
| Padding keepalive | ‚âà0 | +40-150 –±–∞–π—Ç/15 —Å–µ–∫ | 0 |
| Padding data | +50 –Ω—Å (random gen) | +2-5% | 0 |
| QUIC header | ‚âà0 (–∑–∞–º–µ–Ω–∞ 5B ‚Üí 1+4B) | 0% | 0 |

**–ò—Ç–æ–≥–æ:** —Å—É–º–º–∞—Ä–Ω–æ–µ –≤–ª–∏—è–Ω–∏–µ –Ω–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å **–ø—Ä–µ–Ω–µ–±—Ä–µ–∂–∏–º–æ –º–∞–ª–æ**.

---

## –°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å

‚ö†Ô∏è **–ö–∞–∂–¥—ã–π —ç—Ç–∞–ø ‚Äî breaking change.** –í—Å–µ –∫–ª–∏–µ–Ω—Ç—ã (Windows, Android TV, –±–µ–Ω—á–º–∞—Ä–∫) –¥–æ–ª–∂–Ω—ã –æ–±–Ω–æ–≤–ª—è—Ç—å—Å—è —Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ —Å —Å–µ—Ä–≤–µ—Ä–æ–º. –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è:

1. –í–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ—Ç–æ–∫–æ–ª–∞ (–ø–æ–ª–µ Version –≤ wire format)
2. –ü–µ—Ä–∏–æ–¥ dual-stack: —Å–µ—Ä–≤–µ—Ä –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –∏ —Å—Ç–∞—Ä—ã–π, –∏ –Ω–æ–≤—ã–π —Ñ–æ—Ä–º–∞—Ç –≤ —Ç–µ—á–µ–Ω–∏–µ –ø–µ—Ä–µ—Ö–æ–¥–Ω–æ–≥–æ –ø–µ—Ä–∏–æ–¥–∞
3. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –±–µ–Ω—á–º–∞—Ä–∫–∞ (`vpn-server/cmd/vpnbench/`) –ø—Ä–∏ –∫–∞–∂–¥–æ–º –∏–∑–º–µ–Ω–µ–Ω–∏–∏

---

## –¢–µ–∫—É—â–∏–π —É—Ä–æ–≤–µ–Ω—å –º–∞—Å–∫–∏—Ä–æ–≤–∫–∏

> –ê–∫—Ç—É–∞–ª—å–Ω–æ –ø–æ—Å–ª–µ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –≠—Ç–∞–ø–æ–≤ 1‚Äì3 (–ø—Ä–æ—Ç–æ–∫–æ–ª v3, 15.02.2026)

### –û—Ü–µ–Ω–∫–∞ –ø–æ —à–∫–∞–ª–µ –∑—Ä–µ–ª–æ—Å—Ç–∏ DPI-–æ–±—Ö–æ–¥–∞

| –£—Ä–æ–≤–µ–Ω—å | –û–ø–∏—Å–∞–Ω–∏–µ | NovaVPN |
|---------|----------|---------|
| 0 | –ù–∏–∫–∞–∫–æ–π –º–∞—Å–∫–∏—Ä–æ–≤–∫–∏ (WireGuard, OpenVPN) | |
| 1 | –®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ payload (–Ω–µ—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä–Ω—ã—Ö fingerprints –≤ data) | |
| 2 | –û–±—Ñ—É—Å–∫–∞—Ü–∏—è –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤ + padding (–Ω–µ—Ç –æ—Ç–∫—Ä—ã—Ç—ã—Ö –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö, –Ω–µ—Ç —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Ä–∞–∑–º–µ—Ä–æ–≤) | |
| **3** | **–ò–º–∏—Ç–∞—Ü–∏—è –ª–µ–≥–∏—Ç–∏–º–Ω–æ–≥–æ –ø—Ä–æ—Ç–æ–∫–æ–ª–∞ (QUIC Short Header)** | **‚úÖ –°–µ–π—á–∞—Å** |
| 4 | –ü–æ–ª–Ω–∞—è –∏–º–∏—Ç–∞—Ü–∏—è —Å handshake (Trojan-—É—Ä–æ–≤–µ–Ω—å) | ‚Üê –≠—Ç–∞–ø 4 (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π) |

### –ß—Ç–æ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç —Ç–µ–∫—É—â–∞—è –º–∞—Å–∫–∏—Ä–æ–≤–∫–∞

| –°–ª–æ–π –∑–∞—â–∏—Ç—ã | –†–µ–∞–ª–∏–∑–∞—Ü–∏—è | –ß—Ç–æ —Å–∫—Ä—ã–≤–∞–µ—Ç |
|-------------|-----------|--------------|
| QUIC Short Header (5B) | `0x40 \| rand(6 bits)` + 4 random bytes | –ü—Ä–æ—Ç–æ–∫–æ–ª—å–Ω–∞—è –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–Ω–æ—Å—Ç—å ‚Äî DPI –≤–∏–¥–∏—Ç –ª–µ–≥–∏—Ç–∏–º–Ω—ã–π QUIC |
| XOR-–æ–±—Ñ—É—Å–∫–∞—Ü–∏—è –∑–∞–≥–æ–ª–æ–≤–∫–∞ | `HMAC-SHA256(PSK, "nova-header-mask")[:9]` | SessionID, PacketType, Counter ‚Äî –Ω–µ—Ç –æ—Ç–∫—Ä—ã—Ç—ã—Ö –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö |
| –†–∞–Ω–¥–æ–º–Ω—ã–π SessionID | `crypto/rand` 4 –±–∞–π—Ç–∞, –ø—Ä–æ–≤–µ—Ä–∫–∞ —É–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç–∏ | –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏ –ø–æ—Ä—è–¥–æ–∫ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫–ª–∏–µ–Ω—Ç–æ–≤ |
| Padding keepalive/disconnect | 40‚Äì150 —Å–ª—É—á–∞–π–Ω—ã—Ö –±–∞–π—Ç | –§–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ä–∞–∑–º–µ—Ä —Å–ª—É–∂–µ–±–Ω—ã—Ö –ø–∞–∫–µ—Ç–æ–≤ |
| Padding data | Align 64B + rand 0‚Äì32B –≤–Ω—É—Ç—Ä–∏ —à–∏—Ñ—Ä–æ—Ç–µ–∫—Å—Ç–∞ | –ö–æ—Ä—Ä–µ–ª—è—Ü–∏—è —Ä–∞–∑–º–µ—Ä–∞ –ø–∞–∫–µ—Ç–∞ —Å IP-–ø–∞–∫–µ—Ç–æ–º –≤–Ω—É—Ç—Ä–∏ |
| Padding handshake | 100‚Äì400 —Å–ª—É—á–∞–π–Ω—ã—Ö –±–∞–π—Ç | –§–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ä–∞–∑–º–µ—Ä handshake-–ø–∞–∫–µ—Ç–æ–≤ |
| –†–∞–Ω–¥–æ–º–∏–∑–∞—Ü–∏—è keepalive –∏–Ω—Ç–µ—Ä–≤–∞–ª–∞ | 10‚Äì20—Å (–∫–ª–∏–µ–Ω—Ç), 18‚Äì32—Å (—Å–µ—Ä–≤–µ—Ä) | –ü–µ—Ä–∏–æ–¥–∏—á–Ω–æ—Å—Ç—å keepalive |
| ChaCha20 XOR (data) | –ë–µ–∑ auth tag, high-entropy | –°–æ–¥–µ—Ä–∂–∏–º–æ–µ IP-–ø–∞–∫–µ—Ç–æ–≤ |
| ChaCha20-Poly1305 AEAD (handshake) | –° –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–µ–π | Handshake-payload |
| –ú–æ–ª—á–∞–ª–∏–≤—ã–π drop –æ—à–∏–±–æ–∫ | –ù–µ—Ç Error-–ø–∞–∫–µ—Ç–æ–≤ | –§–∞–∫—Ç –∏ —Ç–∏–ø –æ—à–∏–±–∫–∏ (–Ω–µ—Ç ASCII-fingerprint) |
| –ü–æ—Ä—Ç 443/UDP | –°–æ–≤–ø–∞–¥–∞–µ—Ç —Å YouTube, Gmail, Google Maps‚Ä¶ | –ü–æ—Ä—Ç –Ω–µ –≤—ã–¥–µ–ª—è–µ—Ç—Å—è –∏–∑ –ª–µ–≥–∏—Ç–∏–º–Ω–æ–≥–æ QUIC —Ç—Ä–∞—Ñ–∏–∫–∞ |

### –ß—Ç–æ –æ—Å—Ç–∞—ë—Ç—Å—è –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–æ —É—è–∑–≤–∏–º—ã–º

| # | –í–µ–∫—Ç–æ—Ä –∞—Ç–∞–∫–∏ | –°–µ—Ä—å—ë–∑–Ω–æ—Å—Ç—å | –û–ø–∏—Å–∞–Ω–∏–µ | –ú–∏—Ç–∏–≥–∞—Ü–∏—è |
|---|-------------|-------------|----------|-----------|
| 1 | **–ù–µ—Ç QUIC Initial** | üü° –°—Ä–µ–¥–Ω—è—è | –ù–∞—Å—Ç–æ—è—â–∏–π QUIC-–ø–æ—Ç–æ–∫ –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å QUIC Initial (Long Header), —É –Ω–∞—Å –µ–≥–æ –Ω–µ—Ç. Stateful DPI –º–æ–∂–µ—Ç –∑–∞–º–µ—Ç–∏—Ç—å, —á—Ç–æ Short Header –ø–∞–∫–µ—Ç—ã –∏–¥—É—Ç –±–µ–∑ –ø—Ä–µ–¥—à–µ—Å—Ç–≤—É—é—â–µ–≥–æ Initial | –≠—Ç–∞–ø 4 (–∏–º–∏—Ç–∞—Ü–∏—è QUIC Initial) ‚Äî –ø–æ–∫–∞ –Ω–µ—Ç —Ä–µ–∞–ª—å–Ω–æ–π –ø–æ—Ç—Ä–µ–±–Ω–æ—Å—Ç–∏. –ë–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ DPI –Ω–µ –æ—Ç—Å–ª–µ–∂–∏–≤–∞—é—Ç —Å–æ—Å—Ç–æ—è–Ω–∏–µ QUIC-–ø–æ—Ç–æ–∫–æ–≤ |
| 2 | **ServerPubKey –≤ HandshakeResp** | üü° –°—Ä–µ–¥–Ω—è—è | –ü–µ—Ä–≤—ã–µ 32 –±–∞–π—Ç–∞ payload Resp ‚Äî raw Curve25519 public key. –í—Å–µ–≥–¥–∞ high-entropy, —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ä–∞–∑–º–µ—Ä (32B) | –û–±—ë—Ä–Ω—É—Ç –≤ AEAD, —Å–∫—Ä—ã—Ç padding'–æ–º. –î–ª—è DPI ‚Äî —á–∞—Å—Ç—å –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –ø–æ—Ç–æ–∫–∞ |
| 3 | **–ù–µ—Ç SNI / ALPN** | üü¢ –ù–∏–∑–∫–∞—è | –ù–∞—Å—Ç–æ—è—â–∏–π QUIC –Ω–µ—Å—ë—Ç TLS ClientHello —Å SNI –≤–Ω—É—Ç—Ä–∏ Initial. –£ –Ω–∞—Å –Ω–µ—Ç ‚Äî –Ω–æ –º—ã –∏ –Ω–µ –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º Initial | –ê–∫—Ç—É–∞–ª—å–Ω–æ —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –∏–º–∏—Ç–∏—Ä–æ–≤–∞—Ç—å QUIC Initial (–≠—Ç–∞–ø 4) |
| 4 | **–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ Retry / Version Negotiation** | üü¢ –ù–∏–∑–∫–∞—è | –ù–∞—Å—Ç–æ—è—â–∏–π QUIC –º–æ–∂–µ—Ç –≤–∫–ª—é—á–∞—Ç—å Retry —Ç–æ–∫–µ–Ω, Version Negotiation | –î–ª—è Short Header –ø–∞–∫–µ—Ç–æ–≤ —ç—Ç–æ –Ω–µ–∞–∫—Ç—É–∞–ª—å–Ω–æ ‚Äî –æ–Ω–∏ –∏–¥—É—Ç –ø–æ—Å–ª–µ handshake |
| 5 | **–°—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑ –æ–±—ä—ë–º–∞** | üü¢ –ù–∏–∑–∫–∞—è | ML-–º–æ–¥–µ–ª–∏ –º–æ–≥—É—Ç –≤—ã—è–≤–ª—è—Ç—å –ø–∞—Ç—Ç–µ—Ä–Ω VPN-—Ç—Ä–∞—Ñ–∏–∫–∞ –ø–æ —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏—é upload/download, burst patterns | Padding —Å–Ω–∏–∂–∞–µ—Ç –∫–æ—Ä—Ä–µ–ª—è—Ü–∏—é, –Ω–æ –Ω–µ —É—Å—Ç—Ä–∞–Ω—è–µ—Ç –ø–æ–ª–Ω–æ—Å—Ç—å—é. –†–µ—à–µ–Ω–∏—è: traffic shaping (–¥–æ—Ä–æ–≥–æ) |

### –ö—Ç–æ —á—Ç–æ –¥–µ—Ç–µ–∫—Ç–∏—Ä—É–µ—Ç

| DPI | –î–µ—Ç–µ–∫—Ç–∏—Ä—É–µ—Ç NovaVPN v3? | –ú–µ—Ç–æ–¥ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è | –°–ª–æ–∂–Ω–æ—Å—Ç—å –æ–±—Ö–æ–¥–∞ |
|-----|------------------------|-------------------|-----------------|
| –ü—Ä–æ—Å—Ç–æ–π firewall (–ø–æ—Ä—Ç+–ø—Ä–æ—Ç–æ–∫–æ–ª) | ‚ùå –ù–µ—Ç | ‚Äî | –û–±—Ö–æ–¥ –Ω–µ –Ω—É–∂–µ–Ω |
| Passive DPI (header inspection) | ‚ùå –ù–µ—Ç | ‚Äî | –ó–∞–≥–æ–ª–æ–≤–æ–∫ = –≤–∞–ª–∏–¥–Ω—ã–π QUIC Short Header |
| Packet-size DPI (—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ä–∞–∑–º–µ—Ä—ã) | ‚ùå –ù–µ—Ç | ‚Äî | –í—Å–µ –ø–∞–∫–µ—Ç—ã —Ä–∞–Ω–¥–æ–º–∏–∑–∏—Ä–æ–≤–∞–Ω—ã padding'–æ–º |
| Stateful DPI (–ø—Ä–æ—Ç–æ–∫–æ–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑) | ‚ö†Ô∏è –°–ª–æ–∂–Ω–æ | –ù–µ—Ç QUIC Initial –ø–µ—Ä–µ–¥ Short Header | –¢—Ä–µ–±—É–µ—Ç –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è state –∫–∞–∂–¥–æ–≥–æ UDP-–ø–æ—Ç–æ–∫–∞ |
| ML/Statistical DPI (pattern analysis) | ‚ö†Ô∏è –°–ª–æ–∂–Ω–æ | –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–æ–≤, timing | Padding + —Ä–∞–Ω–¥–æ–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∏–Ω—Ç–µ—Ä–≤–∞–ª—ã |
| GFW —É—Ä–æ–≤–Ω—è –ö–∏—Ç–∞—è | ‚ö†Ô∏è –°–ª–æ–∂–Ω–æ | –ö–æ–º–±–∏–Ω–∞—Ü–∏—è stateful + ML + active probing | –¢–µ–∫—É—â–∏–π —É—Ä–æ–≤–µ–Ω—å –¥–æ—Å—Ç–∞—Ç–æ—á–µ–Ω –¥–ª—è –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–∞ —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤ |
| Active probing (–æ—Ç–ø—Ä–∞–≤–∫–∞ —Ç–µ—Å—Ç–æ–≤—ã—Ö –ø–∞–∫–µ—Ç–æ–≤) | ‚ö†Ô∏è –°–ª–æ–∂–Ω–æ | –°–µ—Ä–≤–µ—Ä –º–æ–∂–µ—Ç –æ—Ç–≤–µ—Ç–∏—Ç—å –Ω–∞ crafted-–ø–∞–∫–µ—Ç—ã | –ú–æ–ª—á–∞–ª–∏–≤—ã–π drop –Ω–µ–≤–∞–ª–∏–¥–Ω—ã—Ö –ø–∞–∫–µ—Ç–æ–≤ —É–∂–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω |

---

## –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–∞–º–∏

| –ü—Ä–æ—Ç–æ–∫–æ–ª | –ú–∞—Å–∫–∏—Ä–æ–≤–∫–∞ | –£—Ä–æ–≤–µ–Ω—å | –ú–µ—Ç–æ–¥ | –°–ª–∞–±–æ—Å—Ç–∏ |
|----------|-----------|---------|-------|----------|
| WireGuard | ‚ùå –ù–µ—Ç | 0 | –û—Ç–∫—Ä—ã—Ç—ã–π —Ñ–æ—Ä–º–∞—Ç, —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–π initiator response | –ú–≥–Ω–æ–≤–µ–Ω–Ω–æ –¥–µ—Ç–µ–∫—Ç–∏—Ä—É–µ—Ç—Å—è –∏ –±–ª–æ–∫–∏—Ä—É–µ—Ç—Å—è |
| OpenVPN | ‚ùå –ù–µ—Ç | 0 | –•–∞—Ä–∞–∫—Ç–µ—Ä–Ω—ã–π opcode `0x38`, —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ | Signature-based –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ |
| IPSec/IKEv2 | ‚ùå –ù–µ—Ç | 0 | –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –ø–æ—Ä—Ç—ã (500/4500), ESP header | –®–∏—Ä–æ–∫–æ –±–ª–æ–∫–∏—Ä—É–µ—Ç—Å—è |
| Shadowsocks-AEAD | ‚úÖ –•–æ—Ä–æ—à–∞—è | 2 | –ü–æ–ª–Ω–æ—Å—Ç—å—é –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã–π stream, random-looking | –ù–µ—Ç –∏–º–∏—Ç–∞—Ü–∏–∏ –ø—Ä–æ—Ç–æ–∫–æ–ª–∞, entropy-based detection |
| V2Ray/VMess | ‚úÖ –•–æ—Ä–æ—à–∞—è | 2‚Äì3 | –û–±—Ñ—É—Å–∫–∞—Ü–∏—è + –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–∞—è TLS/QUIC –º–∞—Å–∫–∏—Ä–æ–≤–∫–∞ | –ë–µ–∑ TLS-–æ–±—ë—Ä—Ç–∫–∏ ‚Äî —É—Ä–æ–≤–µ–Ω—å 2 |
| **NovaVPN v3** | **‚úÖ –•–æ—Ä–æ—à–∞—è** | **3** | **QUIC Short Header + –æ–±—Ñ—É—Å—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∑–∞–≥–æ–ª–æ–≤–∫–∏ + padding** | **–ù–µ—Ç QUIC Initial (stateful DPI)** |
| Trojan-GFW | ‚úÖ‚úÖ –û—Ç–ª–∏—á–Ω–∞—è | 4 | –ü–æ–ª–Ω–∞—è –∏–º–∏—Ç–∞—Ü–∏—è HTTPS —Å —Ä–µ–∞–ª—å–Ω—ã–º TLS + —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–º | –¢–æ–ª—å–∫–æ TCP, –≤—ã—Å–æ–∫–∞—è —Å–ª–æ–∂–Ω–æ—Å—Ç—å |
| XTLS-Reality | ‚úÖ‚úÖ –û—Ç–ª–∏—á–Ω–∞—è | 4 | –ü—Ä–æ–∫—Å–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–∞–ª—å–Ω–æ–≥–æ TLS handshake | –¢–æ–ª—å–∫–æ TCP, —Ç—Ä–µ–±—É–µ—Ç target-—Å–µ—Ä–≤–µ—Ä |
